<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Financial Portfolio</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
    }
    
    .card-glass {
      background: rgba(42, 42, 42, 0.9);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 87, 34, 0.2);
    }
    
    .stat-card {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #ff5722 0%, #ff7043 100%);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    @media (hover: hover) {
      .stat-card:hover::before {
        transform: scaleX(1);
      }
      
      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 40px rgba(255, 87, 34, 0.3);
      }
    }
    
    @media (max-width: 640px) {
      .stat-card {
        min-height: 120px;
      }
      
      html, body {
        overflow-x: hidden;
      }
    }
    
    .crypto-icon {
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(0.95); }
    }
    
    .loan-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .loan-card:hover {
      background: rgba(255, 87, 34, 0.05);
      border-color: rgba(255, 87, 34, 0.3);
    }
    
    .action-btn {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      min-height: 44px;
    }
    
    .action-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    @media (hover: hover) {
      .action-btn:hover::before {
        width: 300px;
        height: 300px;
      }
    }
    
    @media (max-width: 640px) {
      .action-btn {
        padding: 14px 20px !important;
        font-size: 14px;
      }
    }
    
    .activity-item {
      transition: all 0.2s ease;
    }
    
    .activity-item:hover {
      background: rgba(255, 87, 34, 0.03);
    }
    
    .price-chart {
      height: 60px;
      background: linear-gradient(180deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%);
    }
    
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 280px;
      height: 100%;
      background: rgba(26, 26, 26, 0.98);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(255, 87, 34, 0.2);
      transform: translateX(-100%);
      transition: transform 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }
    
    @media (max-width: 640px) {
      .sidebar {
        width: 85%;
        max-width: 320px;
      }
    }
    
    .sidebar.open {
      transform: translateX(0);
    }
    
    .sidebar-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1001;
      background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%);
      border: none;
      width: 48px;
      height: 48px;
      border-radius: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 87, 34, 0.4);
    }
    
    .sidebar-toggle:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(255, 87, 34, 0.6);
    }
    
    .sidebar-toggle.open {
      left: 300px;
    }
    
    @media (max-width: 640px) {
      .sidebar-toggle {
        top: 16px;
        left: 16px;
        width: 44px;
        height: 44px;
      }
      
      .sidebar-toggle.open {
        left: calc(85vw - 20px);
      }
    }
    
    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 999;
    }
    
    .sidebar-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    
    .main-content {
      transition: margin-left 0.3s ease;
    }
    
    @media (min-width: 1024px) {
      .main-content.shifted {
        margin-left: 280px;
      }
      
      .sidebar-overlay {
        display: none;
      }
      
      .sidebar {
        transform: translateX(0);
      }
      
      .sidebar-toggle {
        display: none;
      }
    }
    
    @media (max-width: 1023px) {
      .main-content {
        margin-left: 0 !important;
      }
    }
    
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      padding: 20px;
    }
    
    @media (max-width: 640px) {
      .modal {
        padding: 8px;
        align-items: flex-start;
        padding-top: 20px;
      }
    }
    
    @media (max-width: 480px) {
      .modal {
        padding: 4px;
      }
      
      .modal-content {
        border-radius: 12px;
      }
    }
    
    .modal.show {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-content {
      background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
      border: 1px solid rgba(255, 87, 34, 0.3);
      border-radius: 24px;
      max-width: 700px;
      width: 100%;
      max-height: 90%;
      overflow-y: auto;
      transform: scale(0.9);
      transition: transform 0.3s ease;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }
    
    .modal.show .modal-content {
      transform: scale(1);
    }
    
    @media (max-width: 640px) {
      .modal-content {
        border-radius: 16px;
        max-height: 85%;
      }
    }
    
    .feature-item {
      background: rgba(255, 87, 34, 0.05);
      border: 1px solid rgba(255, 87, 34, 0.15);
      border-radius: 12px;
      padding: 16px;
      transition: all 0.3s ease;
    }
    
    .feature-item:hover {
      background: rgba(255, 87, 34, 0.1);
      border-color: rgba(255, 87, 34, 0.3);
      transform: translateY(-2px);
    }
    
    .process-step {
      display: flex;
      gap: 16px;
      align-items: start;
    }
    
    .step-number {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }
    
    .membership-card {
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    @media (hover: hover) {
      .membership-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 87, 34, 0.5) !important;
      }
    }
    
    .profile-btn {
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .profile-btn:hover {
      background: rgba(255, 87, 34, 0.1) !important;
    }


  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full"><!-- Sidebar Toggle Button --> <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
   <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round"><line x1="3" y1="12" x2="21" y2="12"></line> <line x1="3" y1="6" x2="21" y2="6"></line> <line x1="3" y1="18" x2="21" y2="18"></line>
   </svg></button> <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div><!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
   <div class="p-6"><!-- Sidebar Header -->
    <div class="mb-8">
     <div class="flex items-center gap-3 mb-6">
      <svg width="40" height="40" viewbox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="28" cy="28" r="28" fill="url(#grad2)" /> <defs>
        <lineargradient id="grad2" x1="0" y1="0" x2="56" y2="56">
         <stop offset="0%" style="stop-color:#ff5722;stop-opacity:1" />
         <stop offset="100%" style="stop-color:#ff7043;stop-opacity:1" />
        </lineargradient>
       </defs> <path d="M40.828 24.535c.549-3.668-2.245-5.641-6.064-6.956l1.239-4.969-3.024-.754-1.207 4.838c-.795-.198-1.61-.385-2.423-.57l1.217-4.872-3.022-.754-1.239 4.967c-.658-.15-1.305-.298-1.932-.454l.003-.016-4.172-1.041-.805 3.23s2.244.515 2.197.546c1.225.306 1.446 1.116 1.409 1.76l-1.411 5.661c.084.021.193.052.315.1l-.32-.08-1.978 7.931c-.15.371-.53.929-1.388.717.016.044-2.198-.549-2.198-.549l-1.502 3.461 3.937.981c.731.184 1.448.376 2.153.557l-1.251 5.024 3.021.754 1.239-4.971c.826.224 1.627.43 2.411.624l-1.234 4.949 3.024.754 1.251-5.014c5.158.976 9.037.582 10.67-4.082 1.316-3.755-.066-5.923-2.778-7.336 1.977-.456 3.465-1.755 3.862-4.441zm-6.913 9.691c-.933 3.756-7.258 1.726-9.31 1.216l1.662-6.658c2.052.512 8.624 1.526 7.648 5.442zm.936-9.743c-.852 3.418-6.113 1.68-7.822 1.255l1.506-6.038c1.709.426 7.202 1.218 6.316 4.783z" fill="white" />
      </svg>
      <div>
       <h3 class="font-bold text-sm" style="color: #ffffff;">CryptoLoan</h3>
       <p class="text-xs" style="color: #64748b;">Dashboard</p>
      </div>
     </div>
    </div><!-- Navigation Menu -->
    <nav class="space-y-2 mb-8"><a href="#" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-all" style="background: rgba(255, 87, 34, 0.15); color: #ff5722;">
      <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect> <rect x="14" y="3" width="7" height="7"></rect> <rect x="14" y="14" width="7" height="7"></rect> <rect x="3" y="14" width="7" height="7"></rect>
      </svg><span class="text-xs font-medium">Dashboard</span> </a> <a href="#" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-all" style="color: #94a3b8;" id="sidebarActivityBtn" onmouseenter="this.style.background='rgba(255, 87, 34, 0.05)'" onmouseleave="this.style.background='transparent'">
      <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
      </svg><span class="text-xs font-medium">Activity</span> </a> <a href="#" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-all" style="color: #94a3b8;" id="settingsBtn" onmouseenter="this.style.background='rgba(255, 87, 34, 0.05)'" onmouseleave="this.style.background='transparent'">
      <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3" /> <path d="M12 1v6m0 6v6m5.2-13.2L13.4 9.6m-2.8 2.8l-3.8 3.8m13.2.8h-6m-6 0H1m13.2-5.2l-3.8 3.8m-2.8-2.8L3.8 3.8" />
      </svg><span class="text-xs font-medium">Settings</span> </a> <a href="#" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-all" style="color: #94a3b8;" id="helpBtn" onmouseenter="this.style.background='rgba(255, 87, 34, 0.05)'" onmouseleave="this.style.background='transparent'">
      <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" /> <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" /> <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg><span class="text-xs font-medium">Help</span> </a>
    </nav><!-- Loan Information Section -->
    <div class="mb-8">
     <h4 class="text-xs font-semibold uppercase tracking-wider mb-2 px-3" style="color: #64748b;">Loans</h4>
     <div class="px-4"><!-- Active Loan Card --> <button class="w-full mb-2 rounded-lg p-3 text-left transition-all" style="background: rgba(255, 87, 34, 0.05); border: 1px solid rgba(255, 87, 34, 0.2);" id="sidebarLoanBtn" onmouseenter="this.style.background='rgba(255, 87, 34, 0.1)'" onmouseleave="this.style.background='rgba(255, 87, 34, 0.05)'">
       <div class="flex items-center justify-between mb-2"><span class="text-xs px-2 py-0.5 rounded-full font-medium" style="background: rgba(16, 185, 129, 0.15); color: #10b981; font-size: 10px;">Active</span>
        <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2"><path d="M9 18l6-6-6-6" />
        </svg>
       </div><h5 class="text-xs font-bold mb-1.5" style="color: #ffffff;">Your Loan</h5>
       <div class="space-y-0.5 text-xs">
        <div class="flex justify-between" style="font-size: 10px;"><span style="color: #94a3b8;">Amount</span> <span style="color: #ffffff;">$0</span>
        </div>
        <div class="flex justify-between" style="font-size: 10px;"><span style="color: #94a3b8;">Rate</span> <span style="color: #4a9b8e;">10% APR</span>
        </div>
        <div class="flex justify-between" style="font-size: 10px;"><span style="color: #94a3b8;">Collateral</span> <span style="color: #ffffff;">0 BTC</span>
        </div>
       </div></button> <!-- Apply Button --> <button class="w-full px-3 py-2 rounded-lg text-xs font-semibold transition-all" style="background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%); color: #ffffff; box-shadow: 0 4px 12px rgba(255, 87, 34, 0.3);" id="applyLoanBtn" onmouseenter="this.style.boxShadow='0 6px 20px rgba(255, 87, 34, 0.5)'" onmouseleave="this.style.boxShadow='0 4px 12px rgba(255, 87, 34, 0.3)'"> Apply for Loan </button>
     </div>
    </div><!-- Membership Section -->
    <div class="mb-8">
     <h4 class="text-xs font-semibold uppercase tracking-wider mb-2 px-3" style="color: #64748b;">Membership</h4>
     <div class="px-4"><button class="w-full membership-card rounded-lg p-3 text-left border-none" style="background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%); box-shadow: 0 4px 12px rgba(255, 87, 34, 0.3);" id="membershipBtn">
       <div class="flex items-center justify-between mb-2">
        <div class="flex items-center gap-1.5">
         <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
         </svg><span class="font-bold text-xs" style="color: #ffffff;">Premium</span>
        </div>
       </div>
       <div style="background: rgba(255, 255, 255, 0.15); border-radius: 6px; padding: 8px; margin-bottom: 8px;">
        <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 2px; font-size: 9px;">Annual Fee</p>
        <p class="font-bold" style="color: #ffffff; font-size: 14px;">$1,000/yr</p>
        <p style="color: rgba(255, 255, 255, 0.75); margin-top: 2px; font-size: 9px;">Auto-deducted</p>
       </div>
       <div class="space-y-1 mb-2">
        <div class="flex items-center gap-1.5" style="color: rgba(255, 255, 255, 0.95); font-size: 9px;">
         <svg width="10" height="10" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline>
         </svg><span>USD &amp; Bitcoin</span>
        </div>
        <div class="flex items-center gap-1.5" style="color: rgba(255, 255, 255, 0.95); font-size: 9px;">
         <svg width="10" height="10" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline>
         </svg><span>Daily interest</span>
        </div>
        <div class="flex items-center gap-1.5" style="color: rgba(255, 255, 255, 0.95); font-size: 9px;">
         <svg width="10" height="10" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline>
         </svg><span>Loans to $1M</span>
        </div>
        <div class="flex items-center gap-1.5" style="color: rgba(255, 255, 255, 0.95); font-size: 9px;">
         <svg width="10" height="10" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline>
         </svg><span>24/7 support</span>
        </div>
       </div>
       <div class="w-full py-1.5 px-2 rounded-lg text-center" style="background: rgba(255, 255, 255, 0.2); color: #ffffff; font-size: 9px; font-weight: 600;">
        View Details
       </div></button> <!-- Subscribe Button --> <button class="w-full px-3 py-2 rounded-lg text-xs font-semibold transition-all mt-2" style="background: rgba(255, 255, 255, 0.15); color: #ffffff; border: 1px solid rgba(255, 255, 255, 0.3);" id="subscribeBtn" onmouseenter="this.style.background='rgba(255, 255, 255, 0.25)'" onmouseleave="this.style.background='rgba(255, 255, 255, 0.15)'"> Subscribe </button>
     </div>
    </div><!-- User Profile Section -->
    <div class="pt-4 border-t" style="border-color: rgba(255, 87, 34, 0.2);"><button class="w-full profile-btn flex items-center gap-2 px-3 py-2 rounded-lg text-left border-none" style="background: rgba(255, 87, 34, 0.05);" id="profileBtn" onmouseenter="this.style.background='rgba(255, 87, 34, 0.1)'" onmouseleave="this.style.background='rgba(255, 87, 34, 0.05)'">
      <div class="w-8 h-8 rounded-full flex items-center justify-center" style="background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%);"><span class="font-bold text-xs" style="color: #ffffff;">JD</span>
      </div>
      <div class="flex-1">
       <p class="text-xs font-semibold" style="color: #ffffff;">John Doe</p>
       <p style="color: #64748b; font-size: 9px;">Premium</p>
      </div>
      <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="2"><path d="M9 18l6-6-6-6" />
      </svg></button>
    </div>
   </div>
  </aside>
  <div class="w-full h-full overflow-auto gradient-bg main-content">
   <div class="max-w-7xl mx-auto p-4 md:p-8"><!-- Header -->
    <header class="mb-6 sm:mb-8 mt-14 sm:mt-16 lg:mt-0 px-2 sm:px-0">
     <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-3 sm:gap-4 mb-4 sm:mb-6">
      <div class="flex-1">
       <h1 id="dashboard-title" class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold mb-1 sm:mb-2" style="color: #ffffff;">Financial Portfolio</h1>
       <p id="welcome-message" class="text-xs sm:text-sm md:text-base" style="color: #94a3b8;">Monitor your digital assets and loan performance</p>
      </div>
      <div class="crypto-icon flex items-center gap-3">
       <svg width="36" height="36" viewbox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg" class="sm:w-10 sm:h-10 md:w-12 md:h-12"><circle cx="28" cy="28" r="28" fill="url(#grad1)" /> <defs>
         <lineargradient id="grad1" x1="0" y1="0" x2="56" y2="56">
          <stop offset="0%" style="stop-color:#ff5722;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#ff7043;stop-opacity:1" />
         </lineargradient>
        </defs> <path d="M40.828 24.535c.549-3.668-2.245-5.641-6.064-6.956l1.239-4.969-3.024-.754-1.207 4.838c-.795-.198-1.61-.385-2.423-.57l1.217-4.872-3.022-.754-1.239 4.967c-.658-.15-1.305-.298-1.932-.454l.003-.016-4.172-1.041-.805 3.23s2.244.515 2.197.546c1.225.306 1.446 1.116 1.409 1.76l-1.411 5.661c.084.021.193.052.315.1l-.32-.08-1.978 7.931c-.15.371-.53.929-1.388.717.016.044-2.198-.549-2.198-.549l-1.502 3.461 3.937.981c.731.184 1.448.376 2.153.557l-1.251 5.024 3.021.754 1.239-4.971c.826.224 1.627.43 2.411.624l-1.234 4.949 3.024.754 1.251-5.014c5.158.976 9.037.582 10.67-4.082 1.316-3.755-.066-5.923-2.778-7.336 1.977-.456 3.465-1.755 3.862-4.441zm-6.913 9.691c-.933 3.756-7.258 1.726-9.31 1.216l1.662-6.658c2.052.512 8.624 1.526 7.648 5.442zm.936-9.743c-.852 3.418-6.113 1.68-7.822 1.255l1.506-6.038c1.709.426 7.202 1.218 6.316 4.783z" fill="white" />
       </svg>
      </div>
     </div>
    </header><!-- Key Statistics -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8 px-2 sm:px-0"><!-- Total Borrowed -->
     <div class="card-glass rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 stat-card">
      <div class="flex items-center justify-between mb-3 sm:mb-4"><span id="total-borrowed-label" class="text-xs font-medium" style="color: #94a3b8;">Total Borrowed</span>
       <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"></line> <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
       </svg>
      </div>
      <p class="text-lg sm:text-xl md:text-2xl font-bold mb-2" style="color: #ffffff;">$0</p>
      <div class="flex items-center gap-2"><span class="text-xs" style="color: #4a9b8e;">↑ 0%</span> <span class="text-xs" style="color: #64748b;">vs last month</span>
      </div>
     </div><!-- Collateral Value -->
     <div class="card-glass rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 stat-card">
      <div class="flex items-center justify-between mb-3 sm:mb-4"><span id="collateral-label" class="text-xs font-medium" style="color: #94a3b8;">Collateral Value</span>
       <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="#4a9b8e" stroke-width="2"><circle cx="12" cy="12" r="10" /> <path d="M12 6v6l4 2" />
       </svg>
      </div>
      <p class="text-lg sm:text-xl md:text-2xl font-bold mb-2" style="color: #ffffff;">$0</p>
      <div class="flex items-center gap-2"><span class="text-xs font-medium" style="color: #4a9b8e;">0 BTC</span> <span class="text-xs" style="color: #64748b;">locked</span>
      </div>
     </div><!-- Deposit & Withdraw -->
     <div class="card-glass rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 stat-card sm:col-span-2 lg:col-span-1">
      <div class="flex items-center justify-between mb-3 sm:mb-4"><span id="wallet-label" class="text-xs font-medium" style="color: #94a3b8;">Wallet Balance</span>
       <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4" /> <path d="M3 5v14a2 2 0 0 0 2 2h16v-5" /> <path d="M18 12a2 2 0 0 0 0 4h4v-4Z" />
       </svg>
      </div>
      <p class="text-xl sm:text-2xl font-bold mb-4" style="color: #ffffff;">$0.00</p>
      <div class="flex gap-2"><button class="flex-1 px-2 sm:px-3 py-2 rounded-lg text-xs font-semibold transition-all whitespace-nowrap" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: #ffffff; box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);" id="depositBtn" onmouseenter="this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.5)'" onmouseleave="this.style.boxShadow='0 2px 8px rgba(16, 185, 129, 0.3)'"> Deposit </button> <button class="flex-1 px-2 sm:px-3 py-2 rounded-lg text-xs font-semibold transition-all whitespace-nowrap" style="background: rgba(255, 87, 34, 0.1); color: #ff5722; border: 1px solid rgba(255, 87, 34, 0.3);" id="withdrawBtn" onmouseenter="this.style.background='rgba(255, 87, 34, 0.15)'" onmouseleave="this.style.background='rgba(255, 87, 34, 0.1)'"> Withdraw </button>
      </div>
     </div>
    </div><!-- Bottom Section -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 px-2 sm:px-0"><!-- Bitcoin Price Tracker -->
     <div class="card-glass rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6">
      <div class="flex items-center justify-between mb-4 sm:mb-6">
       <h2 class="text-base sm:text-lg font-bold" style="color: #ffffff;">Bitcoin Market</h2><span class="text-xs px-2 py-1 rounded-full font-medium" style="background: rgba(16, 185, 129, 0.15); color: #10b981;">● Live</span>
      </div>
      <div class="mb-4">
       <p class="text-xs mb-2" style="color: #64748b;">Current Price</p>
       <p id="btc-price" class="text-xl sm:text-2xl md:text-3xl font-bold mb-1" style="color: #ffffff;">Loading...</p>
       <p id="btc-change" class="text-xs" style="color: #10b981;">--</p>
      </div>
      <div class="grid grid-cols-2 gap-3 sm:gap-4 pt-3 sm:pt-4 border-t" style="border-color: rgba(99, 102, 241, 0.1);">
       <div>
        <p class="text-xs mb-1" style="color: #64748b;">24h High</p>
        <p id="btc-high" class="text-sm font-semibold" style="color: #ffffff;">Loading...</p>
       </div>
       <div>
        <p class="text-xs mb-1" style="color: #64748b;">24h Low</p>
        <p id="btc-low" class="text-sm font-semibold" style="color: #ffffff;">Loading...</p>
       </div>
       <div>
        <p class="text-xs mb-1" style="color: #64748b;">24h Volume</p>
        <p id="btc-volume" class="text-sm font-semibold" style="color: #ffffff;">Loading...</p>
       </div>
       <div>
        <p class="text-xs mb-1" style="color: #64748b;">Market Cap</p>
        <p id="btc-marketcap" class="text-sm font-semibold" style="color: #ffffff;">Loading...</p>
       </div>
      </div>
     </div><!-- Recent Activity -->
     <div class="card-glass rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6">
      <div class="flex items-center justify-between mb-4 sm:mb-6">
       <h2 class="text-base sm:text-lg font-bold" style="color: #ffffff;">Recent Activity</h2><button class="text-xs font-medium transition-all" style="color: #6366f1;" id="viewAllActivityBtn" onmouseenter="this.style.color='#4f46e5'" onmouseleave="this.style.color='#6366f1'">View All</button>
      </div>
      <div class="space-y-3">
       <div class="text-center py-8" style="color: #64748b;">
        <p class="text-xs">No recent activity</p>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    // Sidebar functionality
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebarOverlay = document.getElementById('sidebarOverlay');
    const mainContent = document.querySelector('.main-content');

    function toggleSidebar() {
      sidebar.classList.toggle('open');
      sidebarToggle.classList.toggle('open');
      sidebarOverlay.classList.toggle('show');
      
      if (window.innerWidth >= 1024) {
        mainContent.classList.toggle('shifted');
      }
    }

    sidebarToggle.addEventListener('click', toggleSidebar);
    sidebarOverlay.addEventListener('click', toggleSidebar);

    // Auto-open sidebar on desktop
    if (window.innerWidth >= 1024) {
      sidebar.classList.add('open');
      mainContent.classList.add('shifted');
    }

    // Handle window resize
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 1024) {
        sidebar.classList.add('open');
        mainContent.classList.add('shifted');
        sidebarOverlay.classList.remove('show');
      } else {
        mainContent.classList.remove('shifted');
      }
    });

    // Bitcoin Price Tracker
    async function fetchBitcoinPrice() {
      try {
        const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true');
        const data = await response.json();
        
        const price = data.bitcoin.usd;
        const change24h = data.bitcoin.usd_24h_change;
        const volume24h = data.bitcoin.usd_24h_vol;
        const marketCap = data.bitcoin.usd_market_cap;
        
        document.getElementById('btc-price').textContent = '$' + price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        
        const changeElement = document.getElementById('btc-change');
        const changeText = (change24h >= 0 ? '↑ ' : '↓ ') + Math.abs(change24h).toFixed(2) + '% (24h)';
        changeElement.textContent = changeText;
        changeElement.style.color = change24h >= 0 ? '#10b981' : '#ef4444';
        
        // For high/low, we'll estimate based on current price and change
        const estimatedHigh = price * (1 + Math.abs(change24h) / 100);
        const estimatedLow = price * (1 - Math.abs(change24h) / 100);
        
        document.getElementById('btc-high').textContent = '$' + estimatedHigh.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        document.getElementById('btc-low').textContent = '$' + estimatedLow.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        document.getElementById('btc-volume').textContent = '$' + (volume24h / 1000000000).toFixed(2) + 'B';
        document.getElementById('btc-marketcap').textContent = '$' + (marketCap / 1000000000).toFixed(2) + 'B';
        
      } catch (error) {
        console.error('Error fetching Bitcoin price:', error);
        document.getElementById('btc-price').textContent = 'Unable to load';
        document.getElementById('btc-change').textContent = 'Please refresh';
      }
    }

    // Fetch Bitcoin price on load and every 60 seconds
    fetchBitcoinPrice();
    setInterval(fetchBitcoinPrice, 60000);

    // Deposit button functionality
    document.getElementById('depositBtn').addEventListener('click', function() {
      showBitcoinDepositModal();
    });

    function showBitcoinDepositModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div style="flex: 1;">
            <h2 style="color: #ffffff; font-size: clamp(18px, 5vw, 24px); font-weight: bold; margin-bottom: 6px;">Deposit Bitcoin</h2>
            <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px);">Add funds to your wallet</p>
          </div>
          <button id="closeDepositBtcModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; flex-shrink: 0;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Bitcoin Info Card
      const btcCard = document.createElement('div');
      btcCard.style.padding = '20px';
      btcCard.style.marginBottom = '24px';
      btcCard.style.borderRadius = '16px';
      btcCard.style.background = 'linear-gradient(135deg, rgba(247, 147, 26, 0.15) 0%, rgba(247, 147, 26, 0.05) 100%)';
      btcCard.style.border = '1px solid rgba(247, 147, 26, 0.3)';
      btcCard.innerHTML = `
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
          <div style="width: 56px; height: 56px; border-radius: 50%; background: #f7931a; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="white">
              <path d="M23.638 14.904c-1.602 6.43-8.113 10.34-14.542 8.736C2.67 22.05-1.244 15.525.362 9.105 1.962 2.67 8.475-1.243 14.9.358c6.43 1.605 10.342 8.115 8.738 14.548v-.002zm-6.35-4.613c.24-1.59-.974-2.45-2.64-3.03l.54-2.153-1.315-.33-.525 2.107c-.345-.087-.705-.167-1.064-.25l.526-2.127-1.32-.33-.54 2.165c-.285-.067-.565-.132-.84-.2l-1.815-.45-.35 1.407s.975.225.955.236c.535.136.63.486.615.766l-1.477 5.92c-.075.166-.24.406-.614.314.015.02-.96-.24-.96-.24l-.66 1.51 1.71.426.93.242-.54 2.19 1.32.327.54-2.17c.36.1.705.19 1.05.273l-.51 2.154 1.32.33.545-2.19c2.24.427 3.93.257 4.64-1.774.57-1.637-.03-2.58-1.217-3.196.854-.193 1.5-.76 1.68-1.93h.01zm-3.01 4.22c-.404 1.64-3.157.75-4.05.53l.72-2.9c.896.23 3.757.67 3.33 2.37zm.41-4.24c-.37 1.49-2.662.735-3.405.55l.654-2.64c.744.18 3.137.524 2.75 2.084v.006z"/>
            </svg>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #ffffff; font-size: clamp(16px, 4vw, 20px); font-weight: bold; margin-bottom: 4px;">Bitcoin Network</h3>
            <p style="color: #f7931a; font-size: clamp(12px, 3vw, 14px); font-weight: 500;">Fast & Secure Deposits</p>
          </div>
        </div>
        <div style="background: rgba(247, 147, 26, 0.1); border-radius: 12px; padding: 14px;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div>
              <p style="color: #94a3b8; font-size: 11px; margin-bottom: 4px;">Network</p>
              <p style="color: #ffffff; font-size: 13px; font-weight: 600;">Bitcoin</p>
            </div>
            <div>
              <p style="color: #94a3b8; font-size: 11px; margin-bottom: 4px;">Confirmations</p>
              <p style="color: #ffffff; font-size: 13px; font-weight: 600;">3 blocks</p>
            </div>
            <div>
              <p style="color: #94a3b8; font-size: 11px; margin-bottom: 4px;">Est. Time</p>
              <p style="color: #ffffff; font-size: 13px; font-weight: 600;">30-60 mins</p>
            </div>
            <div>
              <p style="color: #94a3b8; font-size: 11px; margin-bottom: 4px;">Min Deposit</p>
              <p style="color: #ffffff; font-size: 13px; font-weight: 600;">0.0001 BTC</p>
            </div>
          </div>
        </div>
      `;
      body.appendChild(btcCard);

      // Warning Alert
      const warningAlert = document.createElement('div');
      warningAlert.style.padding = '16px';
      warningAlert.style.marginBottom = '24px';
      warningAlert.style.borderRadius = '12px';
      warningAlert.style.background = 'rgba(239, 68, 68, 0.1)';
      warningAlert.style.border = '2px solid rgba(239, 68, 68, 0.3)';
      warningAlert.innerHTML = `
        <div style="display: flex; gap: 12px; align-items: start;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2.5" style="flex-shrink: 0; margin-top: 2px;">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <div>
            <h4 style="color: #ef4444; font-size: clamp(13px, 3vw, 14px); font-weight: 700; margin-bottom: 8px;">⚠️ IMPORTANT - READ CAREFULLY</h4>
            <ul style="color: #fca5a5; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.7; margin: 0; padding-left: 18px;">
              <li style="margin-bottom: 6px;"><strong style="color: #ffffff;">Bitcoin ONLY:</strong> Send only BTC on Bitcoin network</li>
              <li style="margin-bottom: 6px;"><strong style="color: #ffffff;">Wrong deposits:</strong> Sending other coins will result in permanent loss</li>
              <li style="margin-bottom: 6px;"><strong style="color: #ffffff;">Minimum:</strong> Deposits below 0.0001 BTC will not be credited</li>
              <li><strong style="color: #ffffff;">Confirmations:</strong> Funds available after 3 blockchain confirmations</li>
            </ul>
          </div>
        </div>
      `;
      body.appendChild(warningAlert);

      // Deposit Address Section
      const addressSection = document.createElement('div');
      addressSection.style.marginBottom = '24px';
      
      // Generate a sample BTC address for demo
      const btcAddress = 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh';
      
      addressSection.innerHTML = `
        <label style="display: block; color: #ffffff; font-size: clamp(13px, 3vw, 15px); font-weight: 600; margin-bottom: 12px;">
          Your Bitcoin Deposit Address
        </label>
        <div style="position: relative; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.3); border-radius: 12px; padding: 14px 50px 14px 16px;">
          <p id="btcDepositAddress" style="color: #ffffff; font-size: clamp(11px, 2.5vw, 13px); font-family: monospace; word-break: break-all; margin: 0;">${btcAddress}</p>
          <button id="copyBtcAddressBtn" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: rgba(255, 87, 34, 0.1); border: none; width: 36px; height: 36px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
          </button>
        </div>
        <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 12px); margin-top: 8px;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle; margin-right: 4px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          This address is unique to your account. Do not share it publicly.
        </p>
      `;
      body.appendChild(addressSection);

      // QR Code Section (placeholder)
      const qrSection = document.createElement('div');
      qrSection.style.marginBottom = '24px';
      qrSection.style.textAlign = 'center';
      qrSection.innerHTML = `
        <div style="background: #ffffff; padding: 20px; border-radius: 16px; display: inline-block; margin-bottom: 12px;">
          <div style="width: 180px; height: 180px; background: linear-gradient(45deg, #f0f0f0 25%, transparent 25%, transparent 75%, #f0f0f0 75%, #f0f0f0), linear-gradient(45deg, #f0f0f0 25%, transparent 25%, transparent 75%, #f0f0f0 75%, #f0f0f0); background-size: 20px 20px; background-position: 0 0, 10px 10px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666666" stroke-width="1.5">
              <rect x="3" y="3" width="7" height="7"></rect>
              <rect x="14" y="3" width="7" height="7"></rect>
              <rect x="14" y="14" width="7" height="7"></rect>
              <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
          </div>
        </div>
        <p style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Scan QR code to get deposit address</p>
      `;
      body.appendChild(qrSection);

      // Deposit Steps
      const stepsSection = document.createElement('div');
      stepsSection.style.marginBottom = '24px';
      stepsSection.innerHTML = `
        <h4 style="color: #ffffff; font-size: clamp(13px, 3vw, 15px); font-weight: 600; margin-bottom: 14px;">How to Deposit</h4>
      `;

      const steps = [
        'Copy the Bitcoin address above or scan the QR code',
        'Send BTC from your wallet to this address',
        'Wait for 3 blockchain confirmations (30-60 minutes)',
        'Click "I Have Sent Bitcoin" button below to track your deposit'
      ];

      steps.forEach((step, index) => {
        const stepItem = document.createElement('div');
        stepItem.style.display = 'flex';
        stepItem.style.gap = '12px';
        stepItem.style.alignItems = 'start';
        stepItem.style.marginBottom = '12px';
        stepItem.innerHTML = `
          <div style="width: 26px; height: 26px; border-radius: 50%; background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <span style="color: #ffffff; font-weight: bold; font-size: 12px;">${index + 1}</span>
          </div>
          <p style="color: #cbd5e1; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.6; margin: 0; padding-top: 3px;">${step}</p>
        `;
        stepsSection.appendChild(stepItem);
      });

      body.appendChild(stepsSection);

      // Confirm Payment Button
      const confirmButton = document.createElement('button');
      confirmButton.id = 'confirmBtcPaymentBtn';
      confirmButton.style.width = '100%';
      confirmButton.style.padding = '16px';
      confirmButton.style.borderRadius = '12px';
      confirmButton.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
      confirmButton.style.border = 'none';
      confirmButton.style.color = '#ffffff';
      confirmButton.style.fontSize = 'clamp(13px, 3vw, 15px)';
      confirmButton.style.fontWeight = '700';
      confirmButton.style.cursor = 'pointer';
      confirmButton.style.transition = 'all 0.3s ease';
      confirmButton.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.3)';
      confirmButton.onmouseenter = function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(16, 185, 129, 0.5)';
      };
      confirmButton.onmouseleave = function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.3)';
      };
      confirmButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          <span>I Have Sent Bitcoin</span>
        </div>
      `;

      confirmButton.addEventListener('click', function() {
        showDepositConfirmationModal(btcAddress, modal);
      });

      body.appendChild(confirmButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Copy address functionality
      document.getElementById('copyBtcAddressBtn').addEventListener('click', function() {
        const address = document.getElementById('btcDepositAddress').textContent;
        navigator.clipboard.writeText(address).then(() => {
          this.innerHTML = `
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          `;
          
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '12px 20px';
          toast.style.borderRadius = '10px';
          toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '13px';
          toast.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = 'Address copied to clipboard!';
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 2000);

          setTimeout(() => {
            this.innerHTML = `
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            `;
          }, 2000);
        });
      });

      // Close modal functionality
      document.getElementById('closeDepositBtcModal').addEventListener('click', function() {
        modal.remove();
      });

      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function showDepositConfirmationModal(btcAddress, previousModal) {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.85)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2500';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div style="flex: 1;">
            <h2 style="color: #ffffff; font-size: clamp(18px, 5vw, 22px); font-weight: bold; margin-bottom: 6px;">Confirm Your Deposit</h2>
            <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px);">Help us verify your Bitcoin transaction</p>
          </div>
          <button id="closeConfirmModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; flex-shrink: 0;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Deposit Address Display
      const addressDisplay = document.createElement('div');
      addressDisplay.style.padding = '16px';
      addressDisplay.style.marginBottom = '24px';
      addressDisplay.style.borderRadius = '12px';
      addressDisplay.style.background = 'rgba(99, 102, 241, 0.1)';
      addressDisplay.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      addressDisplay.innerHTML = `
        <p style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 12px); margin-bottom: 8px;">You sent Bitcoin to:</p>
        <p style="color: #ffffff; font-size: clamp(11px, 2.5vw, 13px); font-family: monospace; word-break: break-all;">${btcAddress}</p>
      `;
      body.appendChild(addressDisplay);

      // Transaction Hash Input
      const txHashSection = document.createElement('div');
      txHashSection.style.marginBottom = '24px';
      txHashSection.innerHTML = `
        <label for="txHashInput" style="display: block; color: #ffffff; font-size: clamp(13px, 3vw, 14px); font-weight: 600; margin-bottom: 12px;">
          Transaction Hash (Optional)
          <span style="color: #64748b; font-weight: 400; margin-left: 6px;">- Helps us find your deposit faster</span>
        </label>
        <input 
          type="text" 
          id="txHashInput" 
          placeholder="Enter transaction hash (e.g., 3a7bd...)" 
          style="width: 100%; padding: 14px 16px; border-radius: 12px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: clamp(12px, 3vw, 14px); font-family: monospace; outline: none; transition: all 0.3s ease;"
          onfocus="this.style.borderColor='#ff5722'"
          onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'"
        />
        <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 12px); margin-top: 8px;">
          You can find the transaction hash in your wallet's transaction history
        </p>
      `;
      body.appendChild(txHashSection);

      // Amount Input
      const amountSection = document.createElement('div');
      amountSection.style.marginBottom = '24px';
      amountSection.innerHTML = `
        <label for="amountInput" style="display: block; color: #ffffff; font-size: clamp(13px, 3vw, 14px); font-weight: 600; margin-bottom: 12px;">
          Amount Sent (BTC)
          <span style="color: #ef4444; margin-left: 4px;">*</span>
        </label>
        <div style="position: relative;">
          <input 
            type="number" 
            id="amountInput" 
            placeholder="0.00000000" 
            min="0.0001"
            step="0.00000001"
            style="width: 100%; padding: 14px 60px 14px 16px; border-radius: 12px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: clamp(14px, 3vw, 18px); font-weight: 600; outline: none; transition: all 0.3s ease;"
            onfocus="this.style.borderColor='#ff5722'"
            onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'"
          />
          <span style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); color: #f7931a; font-size: clamp(12px, 3vw, 14px); font-weight: 600;">BTC</span>
        </div>
        <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 12px); margin-top: 8px;">
          Minimum deposit: 0.0001 BTC
        </p>
      `;
      body.appendChild(amountSection);

      // Info Notice
      const infoNotice = document.createElement('div');
      infoNotice.style.padding = '16px';
      infoNotice.style.marginBottom = '24px';
      infoNotice.style.borderRadius = '12px';
      infoNotice.style.background = 'rgba(99, 102, 241, 0.1)';
      infoNotice.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      infoNotice.innerHTML = `
        <div style="display: flex; gap: 12px; align-items: start;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          <div>
            <h4 style="color: #6366f1; font-size: clamp(12px, 3vw, 14px); font-weight: 600; margin-bottom: 6px;">What happens next?</h4>
            <p style="color: #cbd5e1; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.6;">After you submit this form, we'll start monitoring the blockchain for your transaction. You'll receive a notification once we detect your deposit. This usually takes 30-60 minutes for confirmation.</p>
          </div>
        </div>
      `;
      body.appendChild(infoNotice);

      // Submit Button
      const submitButton = document.createElement('button');
      submitButton.id = 'submitConfirmBtn';
      submitButton.style.width = '100%';
      submitButton.style.padding = '16px';
      submitButton.style.borderRadius = '12px';
      submitButton.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      submitButton.style.border = 'none';
      submitButton.style.color = '#ffffff';
      submitButton.style.fontSize = 'clamp(13px, 3vw, 15px)';
      submitButton.style.fontWeight = '700';
      submitButton.style.cursor = 'pointer';
      submitButton.style.transition = 'all 0.3s ease';
      submitButton.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      submitButton.onmouseenter = function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(255, 87, 34, 0.5)';
      };
      submitButton.onmouseleave = function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      };
      submitButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          <span>Confirm Deposit & Start Tracking</span>
        </div>
      `;

      submitButton.addEventListener('click', function() {
        const amount = document.getElementById('amountInput').value;
        const txHash = document.getElementById('txHashInput').value;

        if (!amount || parseFloat(amount) < 0.0001) {
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '16px 24px';
          toast.style.borderRadius = '12px';
          toast.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '14px';
          toast.style.boxShadow = '0 4px 12px rgba(239, 68, 68, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = 'Please enter amount (minimum 0.0001 BTC)';
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 3000);
          return;
        }

        verifyBitcoinDeposit(amount, txHash, btcAddress, modal, previousModal);
      });

      body.appendChild(submitButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeConfirmModal').addEventListener('click', function() {
        modal.remove();
      });

      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function verifyBitcoinDeposit(amount, txHash, address, confirmModal, depositModal) {
      // Create verification overlay
      const verificationOverlay = document.createElement('div');
      verificationOverlay.style.position = 'fixed';
      verificationOverlay.style.top = '0';
      verificationOverlay.style.left = '0';
      verificationOverlay.style.right = '0';
      verificationOverlay.style.bottom = '0';
      verificationOverlay.style.background = 'rgba(0, 0, 0, 0.95)';
      verificationOverlay.style.display = 'flex';
      verificationOverlay.style.alignItems = 'center';
      verificationOverlay.style.justifyContent = 'center';
      verificationOverlay.style.zIndex = '3000';
      verificationOverlay.style.padding = '20px';

      verificationOverlay.innerHTML = `
        <div style="text-align: center; max-width: 450px; padding: 20px;">
          <div style="width: 80px; height: 80px; border: 4px solid rgba(247, 147, 26, 0.2); border-top-color: #f7931a; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 24px;"></div>
          <h3 style="color: #ffffff; font-size: clamp(18px, 5vw, 22px); font-weight: 700; margin-bottom: 12px;">Tracking Your Deposit</h3>
          <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px); margin-bottom: 24px;">Scanning the Bitcoin blockchain...</p>
          <div id="trackingSteps" style="text-align: left; max-width: 350px; margin: 0 auto;">
            <div class="track-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="track-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Connecting to blockchain</span>
            </div>
            <div class="track-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="track-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Verifying transaction</span>
            </div>
            <div class="track-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="track-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Confirming amount</span>
            </div>
            <div class="track-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="track-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Crediting your account</span>
            </div>
          </div>
        </div>
        <style>
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      `;

      document.body.appendChild(verificationOverlay);

      // Animate tracking steps
      const steps = verificationOverlay.querySelectorAll('.track-step');
      let currentStep = 0;

      const animateStep = () => {
        if (currentStep < steps.length) {
          const step = steps[currentStep];
          step.style.opacity = '1';
          const icon = step.querySelector('.track-icon');
          icon.style.borderColor = '#f7931a';
          icon.querySelector('div').style.background = '#f7931a';

          setTimeout(() => {
            icon.innerHTML = `
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            `;
            icon.style.background = '#10b981';
            icon.style.borderColor = '#10b981';

            currentStep++;
            if (currentStep < steps.length) {
              setTimeout(animateStep, 800);
            } else {
              setTimeout(showDepositSuccess, 900);
            }
          }, 900);
        }
      };

      const showDepositSuccess = () => {
        verificationOverlay.innerHTML = `
          <div style="text-align: center; max-width: 500px; padding: 30px;">
            <div style="width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg, #10b981 0%, #059669 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);">
              <svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            </div>
            <h3 style="color: #ffffff; font-size: clamp(20px, 5vw, 28px); font-weight: 700; margin-bottom: 16px;">Deposit Tracking Started!</h3>
            <p style="color: #10b981; font-size: clamp(16px, 4vw, 20px); font-weight: 600; margin-bottom: 12px;">${amount} BTC</p>
            <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px); margin-bottom: 28px; line-height: 1.6;">We're now monitoring the blockchain for your transaction. You'll receive a notification once your deposit is confirmed.</p>

            <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 24px; text-align: left;">
              <h4 style="color: #ffffff; font-size: clamp(13px, 3vw, 15px); font-weight: 600; margin-bottom: 14px;">Transaction Details</h4>
              <div style="margin-bottom: 12px;">
                <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Amount</p>
                <p style="color: #ffffff; font-size: clamp(12px, 3vw, 14px); font-weight: 600;">${amount} BTC</p>
              </div>
              ${txHash ? `
                <div style="margin-bottom: 12px;">
                  <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Transaction Hash</p>
                  <p style="color: #ffffff; font-size: clamp(10px, 2.5vw, 11px); font-family: monospace; word-break: break-all;">${txHash}</p>
                </div>
              ` : ''}
              <div style="margin-bottom: 12px;">
                <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Deposit Address</p>
                <p style="color: #ffffff; font-size: clamp(10px, 2.5vw, 11px); font-family: monospace; word-break: break-all;">${address}</p>
              </div>
              <div>
                <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Status</p>
                <div style="display: inline-flex; align-items: center; gap: 6px; background: rgba(245, 158, 11, 0.2); padding: 4px 10px; border-radius: 12px;">
                  <div style="width: 6px; height: 6px; border-radius: 50%; background: #f59e0b;"></div>
                  <span style="color: #f59e0b; font-size: clamp(10px, 2.5vw, 12px); font-weight: 600;">Pending Confirmation</span>
                </div>
              </div>
            </div>

            <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 12px; padding: 14px; margin-bottom: 24px;">
              <div style="display: flex; gap: 10px; align-items: start;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                <p style="color: #cbd5e1; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.6; text-align: left;">Your funds will be available after 3 blockchain confirmations (typically 30-60 minutes). Check your email for updates.</p>
              </div>
            </div>

            <button id="closeDepositSuccess" style="width: 100%; padding: 16px; border-radius: 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; color: #ffffff; font-size: clamp(13px, 3vw, 15px); font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
              Return to Dashboard
            </button>
          </div>
        `;

        document.getElementById('closeDepositSuccess').addEventListener('click', function() {
          verificationOverlay.remove();
          if (confirmModal) confirmModal.remove();
          if (depositModal) depositModal.remove();

          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '16px 24px';
          toast.style.borderRadius = '12px';
          toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '14px';
          toast.style.boxShadow = '0 8px 24px rgba(16, 185, 129, 0.5)';
          toast.style.zIndex = '3000';
          toast.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              <span>Deposit tracking active! We'll notify you when confirmed.</span>
            </div>
          `;
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 5000);
        });
      };

      setTimeout(animateStep, 500);
    }

    // Withdraw button functionality
    document.getElementById('withdrawBtn').addEventListener('click', function() {
      showWithdrawModal();
    });

    function showWithdrawModal() {
      // Simulated account state (in real app, this would come from backend)
      const accountState = {
        walletBalance: 0, // USD balance available for withdrawal
        btcBalance: 0, // BTC balance
        hasActiveLoan: false, // Whether user has borrowed
        loanAmount: 0, // Amount borrowed
        collateralBTC: 0, // BTC locked as collateral
        collateralUSD: 0 // USD value of collateral
      };

      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div style="flex: 1;">
            <h2 style="color: #ffffff; font-size: clamp(18px, 5vw, 22px); font-weight: bold; margin-bottom: 6px;">Withdraw Funds</h2>
            <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px);">Choose what to withdraw from your account</p>
          </div>
          <button id="closeWithdrawModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; flex-shrink: 0;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Account Overview Card
      const overviewCard = document.createElement('div');
      overviewCard.style.padding = '20px';
      overviewCard.style.marginBottom = '24px';
      overviewCard.style.borderRadius = '16px';
      overviewCard.style.background = 'rgba(99, 102, 241, 0.1)';
      overviewCard.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      overviewCard.innerHTML = `
        <h3 style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: 600; margin-bottom: 16px;">Your Account Overview</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px;">
          <div style="background: rgba(99, 102, 241, 0.1); padding: 12px; border-radius: 10px;">
            <p style="color: #94a3b8; font-size: 11px; margin-bottom: 4px;">Wallet Balance</p>
            <p style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: bold;">$${accountState.walletBalance.toFixed(2)}</p>
          </div>
          <div style="background: rgba(99, 102, 241, 0.1); padding: 12px; border-radius: 10px;">
            <p style="color: #94a3b8; font-size: 11px; margin-bottom: 4px;">BTC Balance</p>
            <p style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: bold;">${accountState.btcBalance.toFixed(8)} BTC</p>
          </div>
          ${accountState.hasActiveLoan ? `
            <div style="background: rgba(245, 158, 11, 0.1); padding: 12px; border-radius: 10px;">
              <p style="color: #f59e0b; font-size: 11px; margin-bottom: 4px;">Active Loan</p>
              <p style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: bold;">$${accountState.loanAmount.toFixed(2)}</p>
            </div>
            <div style="background: rgba(239, 68, 68, 0.1); padding: 12px; border-radius: 10px;">
              <p style="color: #ef4444; font-size: 11px; margin-bottom: 4px;">Locked Collateral</p>
              <p style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: bold;">${accountState.collateralBTC.toFixed(8)} BTC</p>
            </div>
          ` : ''}
        </div>
      `;
      body.appendChild(overviewCard);

      // Collateral Warning (if loan is active)
      if (accountState.hasActiveLoan) {
        const warningCard = document.createElement('div');
        warningCard.style.padding = '16px';
        warningCard.style.marginBottom = '24px';
        warningCard.style.borderRadius = '12px';
        warningCard.style.background = 'rgba(239, 68, 68, 0.1)';
        warningCard.style.border = '2px solid rgba(239, 68, 68, 0.3)';
        warningCard.innerHTML = `
          <div style="display: flex; gap: 12px; align-items: start;">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2.5" style="flex-shrink: 0; margin-top: 2px;">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
              <line x1="12" y1="11" x2="12" y2="15"></line>
              <line x1="12" y1="7" x2="12.01" y2="7"></line>
            </svg>
            <div>
              <h4 style="color: #ef4444; font-size: clamp(13px, 3vw, 15px); font-weight: 700; margin-bottom: 8px;">🔒 Collateral Locked</h4>
              <p style="color: #fca5a5; font-size: clamp(12px, 2.5vw, 13px); line-height: 1.7; margin-bottom: 8px;">
                You have <strong style="color: #ffffff;">${accountState.collateralBTC.toFixed(8)} BTC</strong> (worth $${accountState.collateralUSD.toFixed(2)}) locked as collateral for your active loan.
              </p>
              <p style="color: #fca5a5; font-size: clamp(12px, 2.5vw, 13px); line-height: 1.7;">
                <strong style="color: #ffffff;">You can only withdraw:</strong>
              </p>
              <ul style="color: #fca5a5; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.6; margin: 8px 0 0 20px; padding: 0;">
                <li>Your loan amount ($${accountState.loanAmount.toFixed(2)})</li>
                <li>Free wallet balance (not used as collateral)</li>
              </ul>
            </div>
          </div>
        `;
        body.appendChild(warningCard);
      }

      // Withdrawal Options Section
      const optionsSection = document.createElement('div');
      optionsSection.style.marginBottom = '24px';
      optionsSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: 600; margin-bottom: 16px;">Select Withdrawal Source</h3>
      `;

      // Option 1: Withdraw from Loan (only if has active loan)
      if (accountState.hasActiveLoan) {
        const loanOption = document.createElement('button');
        loanOption.className = 'withdraw-option';
        loanOption.dataset.type = 'loan';
        loanOption.style.width = '100%';
        loanOption.style.padding = '18px';
        loanOption.style.marginBottom = '12px';
        loanOption.style.borderRadius = '12px';
        loanOption.style.background = 'rgba(245, 158, 11, 0.1)';
        loanOption.style.border = '2px solid rgba(245, 158, 11, 0.3)';
        loanOption.style.cursor = 'pointer';
        loanOption.style.transition = 'all 0.3s ease';
        loanOption.style.textAlign = 'left';
        loanOption.onmouseenter = function() {
          this.style.background = 'rgba(245, 158, 11, 0.15)';
          this.style.borderColor = 'rgba(245, 158, 11, 0.5)';
          this.style.transform = 'translateY(-2px)';
        };
        loanOption.onmouseleave = function() {
          this.style.background = 'rgba(245, 158, 11, 0.1)';
          this.style.borderColor = 'rgba(245, 158, 11, 0.3)';
          this.style.transform = 'translateY(0)';
        };
        loanOption.innerHTML = `
          <div style="display: flex; align-items: center; gap: 16px;">
            <div style="width: 56px; height: 56px; border-radius: 12px; background: rgba(245, 158, 11, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2.5">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </div>
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                <h4 style="color: #ffffff; font-size: clamp(14px, 3vw, 16px); font-weight: 600;">Withdraw from Loan</h4>
                <span style="background: rgba(16, 185, 129, 0.2); color: #10b981; font-size: 10px; padding: 3px 8px; border-radius: 12px; font-weight: 600;">Available</span>
              </div>
              <p style="color: #cbd5e1; font-size: clamp(12px, 2.5vw, 13px); margin-bottom: 8px;">Withdraw your borrowed funds</p>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 12px);">Available Amount:</span>
                <span style="color: #f59e0b; font-size: clamp(13px, 3vw, 15px); font-weight: 700;">$${accountState.loanAmount.toFixed(2)}</span>
              </div>
            </div>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" style="flex-shrink: 0;">
              <path d="M9 18l6-6-6-6"></path>
            </svg>
          </div>
        `;
        loanOption.addEventListener('click', function() {
          showWithdrawForm('loan', accountState.loanAmount, modal);
        });
        optionsSection.appendChild(loanOption);
      }

      // Option 2: Withdraw from Wallet Balance
      const walletOption = document.createElement('button');
      walletOption.className = 'withdraw-option';
      walletOption.dataset.type = 'wallet';
      walletOption.style.width = '100%';
      walletOption.style.padding = '18px';
      walletOption.style.marginBottom = '12px';
      walletOption.style.borderRadius = '12px';
      
      // Calculate available wallet withdrawal (excluding locked collateral)
      const availableWalletUSD = accountState.walletBalance;
      const availableBTC = accountState.hasActiveLoan ? 
        Math.max(0, accountState.btcBalance - accountState.collateralBTC) : 
        accountState.btcBalance;

      const canWithdrawFromWallet = availableWalletUSD > 0 || availableBTC > 0;
      
      if (canWithdrawFromWallet) {
        walletOption.style.background = 'rgba(99, 102, 241, 0.1)';
        walletOption.style.border = '2px solid rgba(99, 102, 241, 0.3)';
        walletOption.style.cursor = 'pointer';
        walletOption.onmouseenter = function() {
          this.style.background = 'rgba(99, 102, 241, 0.15)';
          this.style.borderColor = 'rgba(99, 102, 241, 0.5)';
          this.style.transform = 'translateY(-2px)';
        };
        walletOption.onmouseleave = function() {
          this.style.background = 'rgba(99, 102, 241, 0.1)';
          this.style.borderColor = 'rgba(99, 102, 241, 0.3)';
          this.style.transform = 'translateY(0)';
        };
      } else {
        walletOption.style.background = 'rgba(100, 116, 139, 0.1)';
        walletOption.style.border = '2px solid rgba(100, 116, 139, 0.2)';
        walletOption.style.cursor = 'not-allowed';
        walletOption.style.opacity = '0.6';
      }
      
      walletOption.style.transition = 'all 0.3s ease';
      walletOption.style.textAlign = 'left';
      
      walletOption.innerHTML = `
        <div style="display: flex; align-items: center; gap: 16px;">
          <div style="width: 56px; height: 56px; border-radius: 12px; background: ${canWithdrawFromWallet ? 'rgba(99, 102, 241, 0.2)' : 'rgba(100, 116, 139, 0.2)'}; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="${canWithdrawFromWallet ? '#6366f1' : '#64748b'}" stroke-width="2.5">
              <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
              <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
              <path d="M18 12a2 2 0 0 0 0 4h4v-4Z"></path>
            </svg>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
              <h4 style="color: ${canWithdrawFromWallet ? '#ffffff' : '#64748b'}; font-size: clamp(14px, 3vw, 16px); font-weight: 600;">Withdraw from Balance</h4>
              ${canWithdrawFromWallet ? 
                '<span style="background: rgba(16, 185, 129, 0.2); color: #10b981; font-size: 10px; padding: 3px 8px; border-radius: 12px; font-weight: 600;">Available</span>' :
                '<span style="background: rgba(239, 68, 68, 0.2); color: #ef4444; font-size: 10px; padding: 3px 8px; border-radius: 12px; font-weight: 600;">Insufficient</span>'
              }
            </div>
            <p style="color: ${canWithdrawFromWallet ? '#cbd5e1' : '#64748b'}; font-size: clamp(12px, 2.5vw, 13px); margin-bottom: 8px;">Withdraw your free balance</p>
            <div style="display: flex; flex-direction: column; gap: 4px;">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 12px);">USD Available:</span>
                <span style="color: ${canWithdrawFromWallet ? '#6366f1' : '#64748b'}; font-size: clamp(13px, 3vw, 14px); font-weight: 700;">$${availableWalletUSD.toFixed(2)}</span>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 12px);">BTC Available:</span>
                <span style="color: ${canWithdrawFromWallet ? '#6366f1' : '#64748b'}; font-size: clamp(13px, 3vw, 14px); font-weight: 700;">${availableBTC.toFixed(8)} BTC</span>
              </div>
              ${accountState.hasActiveLoan && accountState.collateralBTC > 0 ? 
                `<p style="color: #ef4444; font-size: clamp(10px, 2vw, 11px); margin-top: 4px;">⚠️ ${accountState.collateralBTC.toFixed(8)} BTC locked as collateral</p>` : 
                ''
              }
            </div>
          </div>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${canWithdrawFromWallet ? '#6366f1' : '#64748b'}" stroke-width="2" style="flex-shrink: 0;">
            <path d="M9 18l6-6-6-6"></path>
          </svg>
        </div>
      `;
      
      if (canWithdrawFromWallet) {
        walletOption.addEventListener('click', function() {
          showWithdrawForm('wallet', { usd: availableWalletUSD, btc: availableBTC }, modal);
        });
      } else {
        walletOption.addEventListener('click', function() {
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '16px 24px';
          toast.style.borderRadius = '12px';
          toast.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '14px';
          toast.style.boxShadow = '0 4px 12px rgba(239, 68, 68, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = 'Insufficient balance for withdrawal. Please deposit funds first.';
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 4000);
        });
      }
      
      optionsSection.appendChild(walletOption);

      body.appendChild(optionsSection);

      // Info Notice
      const infoNotice = document.createElement('div');
      infoNotice.style.padding = '16px';
      infoNotice.style.borderRadius = '12px';
      infoNotice.style.background = 'rgba(99, 102, 241, 0.1)';
      infoNotice.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      infoNotice.innerHTML = `
        <div style="display: flex; gap: 12px; align-items: start;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          <div>
            <h4 style="color: #6366f1; font-size: clamp(12px, 3vw, 14px); font-weight: 600; margin-bottom: 6px;">Withdrawal Information</h4>
            <ul style="color: #cbd5e1; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.7; margin: 0; padding-left: 18px;">
              <li style="margin-bottom: 4px;">Withdrawals are processed to your Bitcoin wallet address</li>
              <li style="margin-bottom: 4px;">Processing time: 30-60 minutes for blockchain confirmation</li>
              ${accountState.hasActiveLoan ? 
                '<li style="margin-bottom: 4px;"><strong>Collateral remains locked</strong> until loan is fully repaid</li>' : 
                ''
              }
              <li>Minimum withdrawal: 0.0001 BTC or $10 USD equivalent</li>
            </ul>
          </div>
        </div>
      `;
      body.appendChild(infoNotice);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeWithdrawModal').addEventListener('click', function() {
        modal.remove();
      });

      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function showWithdrawForm(type, availableAmount, previousModal) {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.85)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2500';
      modal.style.padding = '20px';

      const isLoan = type === 'loan';
      const maxAmount = isLoan ? availableAmount : availableAmount.usd;
      const maxBTC = isLoan ? 0 : availableAmount.btc;

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div style="flex: 1;">
            <h2 style="color: #ffffff; font-size: clamp(18px, 5vw, 22px); font-weight: bold; margin-bottom: 6px;">
              ${isLoan ? 'Withdraw Loan Funds' : 'Withdraw Balance'}
            </h2>
            <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px);">Enter withdrawal details</p>
          </div>
          <button id="closeWithdrawFormModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; flex-shrink: 0;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Available Balance Card
      const balanceCard = document.createElement('div');
      balanceCard.style.padding = '20px';
      balanceCard.style.marginBottom = '24px';
      balanceCard.style.borderRadius = '16px';
      balanceCard.style.background = isLoan ? 'rgba(245, 158, 11, 0.1)' : 'rgba(99, 102, 241, 0.1)';
      balanceCard.style.border = isLoan ? '1px solid rgba(245, 158, 11, 0.3)' : '1px solid rgba(99, 102, 241, 0.3)';
      balanceCard.innerHTML = `
        <div style="text-align: center;">
          <p style="color: #94a3b8; font-size: clamp(12px, 2.5vw, 13px); margin-bottom: 8px;">Available for Withdrawal</p>
          <p style="color: #ffffff; font-size: clamp(24px, 6vw, 32px); font-weight: bold; margin-bottom: 4px;">$${maxAmount.toFixed(2)}</p>
          ${!isLoan && maxBTC > 0 ? 
            `<p style="color: #6366f1; font-size: clamp(12px, 3vw, 14px); font-weight: 600;">${maxBTC.toFixed(8)} BTC</p>` : 
            ''
          }
        </div>
      `;
      body.appendChild(balanceCard);

      // Withdrawal Address Input
      const addressSection = document.createElement('div');
      addressSection.style.marginBottom = '24px';
      addressSection.innerHTML = `
        <label for="withdrawAddress" style="display: block; color: #ffffff; font-size: clamp(13px, 3vw, 14px); font-weight: 600; margin-bottom: 12px;">
          Bitcoin Wallet Address
          <span style="color: #ef4444; margin-left: 4px;">*</span>
        </label>
        <input 
          type="text" 
          id="withdrawAddress" 
          placeholder="Enter your BTC wallet address (e.g., bc1q...)" 
          style="width: 100%; padding: 14px 16px; border-radius: 12px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: clamp(12px, 3vw, 14px); font-family: monospace; outline: none; transition: all 0.3s ease;"
          onfocus="this.style.borderColor='#ff5722'"
          onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'"
        />
        <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 12px); margin-top: 8px;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle; margin-right: 4px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          Supported formats: Legacy (1...), SegWit (3...), Native SegWit (bc1...)
        </p>
      `;
      body.appendChild(addressSection);

      // Amount Input
      const amountSection = document.createElement('div');
      amountSection.style.marginBottom = '24px';
      amountSection.innerHTML = `
        <label for="withdrawAmount" style="display: block; color: #ffffff; font-size: clamp(13px, 3vw, 14px); font-weight: 600; margin-bottom: 12px;">
          Withdrawal Amount (USD)
          <span style="color: #ef4444; margin-left: 4px;">*</span>
        </label>
        <div style="position: relative;">
          <input 
            type="number" 
            id="withdrawAmount" 
            placeholder="0.00" 
            min="10"
            max="${maxAmount}"
            step="0.01"
            style="width: 100%; padding: 14px 60px 14px 16px; border-radius: 12px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: clamp(14px, 3vw, 18px); font-weight: 600; outline: none; transition: all 0.3s ease;"
            onfocus="this.style.borderColor='#ff5722'"
            onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'"
          />
          <span style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); color: #94a3b8; font-size: clamp(12px, 3vw, 14px); font-weight: 600;">USD</span>
        </div>
        <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 8px;">
          <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 12px);">Minimum: $10.00</p>
          <button id="maxAmountBtn" style="background: rgba(255, 87, 34, 0.1); border: 1px solid rgba(255, 87, 34, 0.3); padding: 6px 12px; border-radius: 8px; color: #ff5722; font-size: clamp(11px, 2.5vw, 12px); font-weight: 600; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.15)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            Max: $${maxAmount.toFixed(2)}
          </button>
        </div>
      `;
      body.appendChild(amountSection);

      // Warning Alert
      const warningAlert = document.createElement('div');
      warningAlert.style.padding = '16px';
      warningAlert.style.marginBottom = '24px';
      warningAlert.style.borderRadius = '12px';
      warningAlert.style.background = 'rgba(239, 68, 68, 0.1)';
      warningAlert.style.border = '2px solid rgba(239, 68, 68, 0.3)';
      warningAlert.innerHTML = `
        <div style="display: flex; gap: 12px; align-items: start;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2.5" style="flex-shrink: 0; margin-top: 2px;">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <div>
            <h4 style="color: #ef4444; font-size: clamp(12px, 3vw, 14px); font-weight: 700; margin-bottom: 8px;">⚠️ IMPORTANT</h4>
            <ul style="color: #fca5a5; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.7; margin: 0; padding-left: 18px;">
              <li style="margin-bottom: 4px;"><strong style="color: #ffffff;">Irreversible:</strong> Withdrawals cannot be canceled once processed</li>
              <li style="margin-bottom: 4px;"><strong style="color: #ffffff;">Verify address:</strong> Double-check your Bitcoin address before confirming</li>
              <li><strong style="color: #ffffff;">Processing time:</strong> 30-60 minutes for blockchain confirmation</li>
            </ul>
          </div>
        </div>
      `;
      body.appendChild(warningAlert);

      // Submit Button
      const submitButton = document.createElement('button');
      submitButton.id = 'submitWithdrawBtn';
      submitButton.disabled = true;
      submitButton.style.width = '100%';
      submitButton.style.padding = '16px';
      submitButton.style.borderRadius = '12px';
      submitButton.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      submitButton.style.border = 'none';
      submitButton.style.color = '#ffffff';
      submitButton.style.fontSize = 'clamp(13px, 3vw, 15px)';
      submitButton.style.fontWeight = '700';
      submitButton.style.cursor = 'not-allowed';
      submitButton.style.transition = 'all 0.3s ease';
      submitButton.style.opacity = '0.5';
      submitButton.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      submitButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          <span>Confirm Withdrawal</span>
        </div>
      `;

      body.appendChild(submitButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Form validation
      const addressInput = document.getElementById('withdrawAddress');
      const amountInput = document.getElementById('withdrawAmount');
      const maxBtn = document.getElementById('maxAmountBtn');

      function validateForm() {
        const address = addressInput.value.trim();
        const amount = parseFloat(amountInput.value) || 0;
        
        const isValidAddress = /^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,62}$/.test(address);
        const isValidAmount = amount >= 10 && amount <= maxAmount;
        
        if (isValidAddress && isValidAmount) {
          submitButton.disabled = false;
          submitButton.style.opacity = '1';
          submitButton.style.cursor = 'pointer';
          addressInput.style.borderColor = '#10b981';
          amountInput.style.borderColor = '#10b981';
        } else {
          submitButton.disabled = true;
          submitButton.style.opacity = '0.5';
          submitButton.style.cursor = 'not-allowed';
          
          if (address.length > 0 && !isValidAddress) {
            addressInput.style.borderColor = '#ef4444';
          }
          
          if (amount > 0 && (amount < 10 || amount > maxAmount)) {
            amountInput.style.borderColor = '#ef4444';
          }
        }
      }

      addressInput.addEventListener('input', validateForm);
      amountInput.addEventListener('input', validateForm);

      maxBtn.addEventListener('click', function() {
        amountInput.value = maxAmount.toFixed(2);
        validateForm();
      });

      // Submit withdrawal
      submitButton.addEventListener('click', function() {
        if (!this.disabled) {
          const address = addressInput.value.trim();
          const amount = parseFloat(amountInput.value);
          processWithdrawal(type, amount, address, modal, previousModal);
        }
      });

      // Close modal functionality
      document.getElementById('closeWithdrawFormModal').addEventListener('click', function() {
        modal.remove();
      });

      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function processWithdrawal(type, amount, address, currentModal, previousModal) {
      // Create processing overlay
      const processingOverlay = document.createElement('div');
      processingOverlay.style.position = 'fixed';
      processingOverlay.style.top = '0';
      processingOverlay.style.left = '0';
      processingOverlay.style.right = '0';
      processingOverlay.style.bottom = '0';
      processingOverlay.style.background = 'rgba(0, 0, 0, 0.95)';
      processingOverlay.style.display = 'flex';
      processingOverlay.style.alignItems = 'center';
      processingOverlay.style.justifyContent = 'center';
      processingOverlay.style.zIndex = '3000';
      processingOverlay.style.padding = '20px';

      processingOverlay.innerHTML = `
        <div style="text-align: center; max-width: 450px; padding: 20px;">
          <div style="width: 80px; height: 80px; border: 4px solid rgba(255, 87, 34, 0.2); border-top-color: #ff5722; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 24px;"></div>
          <h3 style="color: #ffffff; font-size: clamp(18px, 5vw, 22px); font-weight: 700; margin-bottom: 12px;">Processing Withdrawal</h3>
          <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px); margin-bottom: 24px;">Preparing your transaction...</p>
          <div id="withdrawSteps" style="text-align: left; max-width: 350px; margin: 0 auto;">
            <div class="withdraw-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Verifying account</span>
            </div>
            <div class="withdraw-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Validating address</span>
            </div>
            <div class="withdraw-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Creating transaction</span>
            </div>
            <div class="withdraw-step" style="display: flex; align-items: center; gap: 12px; padding: 10px 0; opacity: 0.4;">
              <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: clamp(11px, 2.5vw, 13px);">Broadcasting to network</span>
            </div>
          </div>
        </div>
        <style>
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      `;

      document.body.appendChild(processingOverlay);

      // Animate steps
      const steps = processingOverlay.querySelectorAll('.withdraw-step');
      let currentStep = 0;

      const animateStep = () => {
        if (currentStep < steps.length) {
          const step = steps[currentStep];
          step.style.opacity = '1';
          const icon = step.querySelector('.step-icon');
          icon.style.borderColor = '#ff5722';
          icon.querySelector('div').style.background = '#ff5722';

          setTimeout(() => {
            icon.innerHTML = `
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            `;
            icon.style.background = '#10b981';
            icon.style.borderColor = '#10b981';

            currentStep++;
            if (currentStep < steps.length) {
              setTimeout(animateStep, 800);
            } else {
              setTimeout(() => showWithdrawalSuccess(type, amount, address, processingOverlay, currentModal, previousModal), 900);
            }
          }, 900);
        }
      };

      setTimeout(animateStep, 500);
    }

    function showWithdrawalSuccess(type, amount, address, processingOverlay, currentModal, previousModal) {
      processingOverlay.innerHTML = `
        <div style="text-align: center; max-width: 500px; padding: 30px;">
          <div style="width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg, #10b981 0%, #059669 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);">
            <svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </div>
          <h3 style="color: #ffffff; font-size: clamp(20px, 5vw, 28px); font-weight: 700; margin-bottom: 16px;">Withdrawal Initiated!</h3>
          <p style="color: #10b981; font-size: clamp(16px, 4vw, 20px); font-weight: 600; margin-bottom: 12px;">$${amount.toFixed(2)}</p>
          <p style="color: #94a3b8; font-size: clamp(12px, 3vw, 14px); margin-bottom: 28px; line-height: 1.6;">
            Your withdrawal has been submitted to the Bitcoin network. Funds will arrive at your wallet after blockchain confirmation.
          </p>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 24px; text-align: left;">
            <h4 style="color: #ffffff; font-size: clamp(13px, 3vw, 15px); font-weight: 600; margin-bottom: 14px;">Transaction Details</h4>
            <div style="margin-bottom: 12px;">
              <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Amount</p>
              <p style="color: #ffffff; font-size: clamp(12px, 3vw, 14px); font-weight: 600;">$${amount.toFixed(2)}</p>
            </div>
            <div style="margin-bottom: 12px;">
              <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Source</p>
              <p style="color: #ffffff; font-size: clamp(12px, 3vw, 14px); font-weight: 600;">${type === 'loan' ? 'Loan Funds' : 'Wallet Balance'}</p>
            </div>
            <div style="margin-bottom: 12px;">
              <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Destination Address</p>
              <p style="color: #ffffff; font-size: clamp(10px, 2.5vw, 11px); font-family: monospace; word-break: break-all;">${address}</p>
            </div>
            <div style="margin-bottom: 12px;">
              <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Transaction ID</p>
              <p style="color: #ffffff; font-size: clamp(10px, 2.5vw, 11px); font-family: monospace; word-break: break-all;">${Math.random().toString(36).substr(2, 16).toUpperCase()}</p>
            </div>
            <div>
              <p style="color: #64748b; font-size: clamp(10px, 2.5vw, 11px); margin-bottom: 4px;">Status</p>
              <div style="display: inline-flex; align-items: center; gap: 6px; background: rgba(245, 158, 11, 0.2); padding: 4px 10px; border-radius: 12px;">
                <div style="width: 6px; height: 6px; border-radius: 50%; background: #f59e0b;"></div>
                <span style="color: #f59e0b; font-size: clamp(10px, 2.5vw, 12px); font-weight: 600;">Pending Confirmation</span>
              </div>
            </div>
          </div>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 12px; padding: 14px; margin-bottom: 24px;">
            <div style="display: flex; gap: 10px; align-items: start;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
              </svg>
              <p style="color: #cbd5e1; font-size: clamp(11px, 2.5vw, 13px); line-height: 1.6; text-align: left;">Your funds will be available in your Bitcoin wallet after 3 blockchain confirmations (typically 30-60 minutes). You'll receive an email notification when the transaction is confirmed.</p>
            </div>
          </div>

          <button id="closeWithdrawalSuccess" style="width: 100%; padding: 16px; border-radius: 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; color: #ffffff; font-size: clamp(13px, 3vw, 15px); font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
            Return to Dashboard
          </button>
        </div>
      `;

      document.getElementById('closeWithdrawalSuccess').addEventListener('click', function() {
        processingOverlay.remove();
        if (currentModal) currentModal.remove();
        if (previousModal) previousModal.remove();

        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 8px 24px rgba(16, 185, 129, 0.5)';
        toast.style.zIndex = '3000';
        toast.innerHTML = `
          <div style="display: flex; align-items: center; gap: 10px;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>Withdrawal processing! Check your email for updates.</span>
          </div>
        `;
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 5000);
      });
    }

    // Sidebar loan button functionality
    document.getElementById('sidebarLoanBtn').addEventListener('click', function() {
      showLoanDetailsModal();
    });

    function showLoanDetailsModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '800px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: clamp(20px, 5vw, 28px); font-weight: bold; margin-bottom: 8px;">Bitcoin-Backed Loans</h2>
            <p style="color: #94a3b8; font-size: clamp(13px, 3vw, 15px);">Borrow up to $1 million with your Bitcoin as collateral</p>
          </div>
          <button id="closeLoanModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Loan Overview Card
      const overviewCard = document.createElement('div');
      overviewCard.style.padding = '24px';
      overviewCard.style.marginBottom = '24px';
      overviewCard.style.borderRadius = '16px';
      overviewCard.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      overviewCard.style.boxShadow = '0 8px 24px rgba(255, 87, 34, 0.4)';
      overviewCard.innerHTML = `
        <div style="display: flex; align-items: start; gap: 16px; margin-bottom: 20px;">
          <div style="width: 56px; height: 56px; border-radius: 12px; background: rgba(255, 255, 255, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2.5">
              <line x1="12" y1="1" x2="12" y2="23"></line>
              <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #ffffff; font-size: 20px; font-weight: bold; margin-bottom: 8px;">Xapo Bank Loan Program</h3>
            <p style="color: rgba(255, 255, 255, 0.9); font-size: 14px; line-height: 1.6;">Access instant liquidity without selling your Bitcoin. Borrow cash while keeping your crypto assets secure and maintaining exposure to potential price appreciation.</p>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">Loan Amount</div>
            <div style="color: #ffffff; font-size: 18px; font-weight: bold;">Up to $1M</div>
          </div>
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">LTV Ratio</div>
            <div style="color: #ffffff; font-size: 18px; font-weight: bold;">20% - 40%</div>
          </div>
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">Interest Rate</div>
            <div style="color: #ffffff; font-size: 18px; font-weight: bold;">~10% APR</div>
          </div>
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">Approval Time</div>
            <div style="color: #ffffff; font-size: 18px; font-weight: bold;">&lt;1 Minute</div>
          </div>
        </div>
      `;
      body.appendChild(overviewCard);

      // Key Benefits Section
      const benefitsSection = document.createElement('div');
      benefitsSection.style.marginBottom = '24px';
      benefitsSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 18px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          Key Benefits
        </h3>
      `;

      const benefits = [
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>`,
          title: 'No Selling Required',
          description: 'Borrow cash without selling your Bitcoin. Keep your crypto assets and maintain exposure to potential price gains.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>`,
          title: 'Flexible Terms',
          description: 'Choose from various loan durations: 30, 90, 180, or 365 days with flexible repayment schedules that fit your needs.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"></line>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
          </svg>`,
          title: 'Low Interest',
          description: 'Competitive interest rates around 10% per annum with no hidden fees or surprise charges.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>`,
          title: 'Instant Approval',
          description: 'Get cash in under a minute. Fast processing means you get the funds you need when you need them.'
        }
      ];

      benefits.forEach(benefit => {
        const benefitItem = document.createElement('div');
        benefitItem.style.padding = '16px';
        benefitItem.style.marginBottom = '12px';
        benefitItem.style.borderRadius = '12px';
        benefitItem.style.background = 'rgba(16, 185, 129, 0.05)';
        benefitItem.style.border = '1px solid rgba(16, 185, 129, 0.2)';
        benefitItem.innerHTML = `
          <div style="display: flex; gap: 14px; align-items: start;">
            <div style="flex-shrink: 0; color: #10b981; margin-top: 2px;">
              ${benefit.icon}
            </div>
            <div style="flex: 1;">
              <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin-bottom: 6px;">${benefit.title}</h4>
              <p style="color: #94a3b8; font-size: 13px; line-height: 1.6;">${benefit.description}</p>
            </div>
          </div>
        `;
        benefitsSection.appendChild(benefitItem);
      });

      body.appendChild(benefitsSection);

      // Eligibility Section
      const eligibilitySection = document.createElement('div');
      eligibilitySection.style.marginBottom = '24px';
      eligibilitySection.style.padding = '20px';
      eligibilitySection.style.borderRadius = '12px';
      eligibilitySection.style.background = 'rgba(99, 102, 241, 0.05)';
      eligibilitySection.style.border = '1px solid rgba(99, 102, 241, 0.2)';
      eligibilitySection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 18px; font-weight: 600; margin-bottom: 14px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="8.5" cy="7" r="4"></circle>
            <polyline points="17 11 19 13 23 9"></polyline>
          </svg>
          Eligibility Requirements
        </h3>
        <div style="display: grid; gap: 10px;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <div style="width: 6px; height: 6px; border-radius: 50%; background: #6366f1; flex-shrink: 0;"></div>
            <span style="color: #cbd5e1; font-size: 14px;">Available to individuals outside the US</span>
          </div>
          <div style="display: flex; align-items: center; gap: 10px;">
            <div style="width: 6px; height: 6px; border-radius: 50%; background: #6366f1; flex-shrink: 0;"></div>
            <span style="color: #cbd5e1; font-size: 14px;">Minimum Bitcoin balance required</span>
          </div>
          <div style="display: flex; align-items: center; gap: 10px;">
            <div style="width: 6px; height: 6px; border-radius: 50%; background: #6366f1; flex-shrink: 0;"></div>
            <span style="color: #cbd5e1; font-size: 14px;">Subject to KYC/AML verification</span>
          </div>
          <div style="display: flex; align-items: center; gap: 10px;">
            <div style="width: 6px; height: 6px; border-radius: 50%; background: #6366f1; flex-shrink: 0;"></div>
            <span style="color: #cbd5e1; font-size: 14px;">$1,000 annual Xapo Bank membership fee applies</span>
          </div>
        </div>
      `;
      body.appendChild(eligibilitySection);

      // Repayment Section
      const repaymentSection = document.createElement('div');
      repaymentSection.style.marginBottom = '24px';
      repaymentSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 18px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          Repayment Options
        </h3>
      `;

      const repaymentOptions = [
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>`,
          title: 'Repay Anytime',
          description: 'No penalties for early repayment. Pay back your loan whenever it suits you.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"></line>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
          </svg>`,
          title: 'Multiple Currencies',
          description: 'Use USD or BTC for repayment. Choose what works best for you.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
            <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
            <line x1="12" y1="18" x2="12.01" y2="18"></line>
          </svg>`,
          title: 'Easy Management',
          description: 'Manage your loan through the convenient Xapo Bank mobile app.'
        }
      ];

      repaymentOptions.forEach(option => {
        const optionItem = document.createElement('div');
        optionItem.style.padding = '16px';
        optionItem.style.marginBottom = '12px';
        optionItem.style.borderRadius = '12px';
        optionItem.style.background = 'rgba(245, 158, 11, 0.05)';
        optionItem.style.border = '1px solid rgba(245, 158, 11, 0.2)';
        optionItem.innerHTML = `
          <div style="display: flex; gap: 14px; align-items: start;">
            <div style="flex-shrink: 0; color: #f59e0b; margin-top: 2px;">
              ${option.icon}
            </div>
            <div style="flex: 1;">
              <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin-bottom: 6px;">${option.title}</h4>
              <p style="color: #94a3b8; font-size: 13px; line-height: 1.6;">${option.description}</p>
            </div>
          </div>
        `;
        repaymentSection.appendChild(optionItem);
      });

      body.appendChild(repaymentSection);

      // Action Buttons
      const actionButtons = document.createElement('div');
      actionButtons.style.display = 'grid';
      actionButtons.style.gridTemplateColumns = 'repeat(auto-fit, minmax(200px, 1fr))';
      actionButtons.style.gap = '12px';
      actionButtons.style.marginTop = '24px';
      
      const applyButton = document.createElement('button');
      applyButton.style.padding = '16px 24px';
      applyButton.style.borderRadius = '12px';
      applyButton.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      applyButton.style.border = 'none';
      applyButton.style.color = '#ffffff';
      applyButton.style.fontSize = '15px';
      applyButton.style.fontWeight = '600';
      applyButton.style.cursor = 'pointer';
      applyButton.style.transition = 'all 0.3s ease';
      applyButton.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      applyButton.onmouseenter = function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(255, 87, 34, 0.5)';
      };
      applyButton.onmouseleave = function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      };
      applyButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="12" y1="18" x2="12" y2="12"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
          <span>Apply for Loan</span>
        </div>
      `;
      applyButton.addEventListener('click', function() {
        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.4)';
        toast.style.zIndex = '3000';
        toast.textContent = 'Redirecting to Xapo Bank application...';
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 3000);
      });

      const learnMoreButton = document.createElement('button');
      learnMoreButton.style.padding = '16px 24px';
      learnMoreButton.style.borderRadius = '12px';
      learnMoreButton.style.background = 'rgba(255, 87, 34, 0.1)';
      learnMoreButton.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      learnMoreButton.style.color = '#ff5722';
      learnMoreButton.style.fontSize = '15px';
      learnMoreButton.style.fontWeight = '600';
      learnMoreButton.style.cursor = 'pointer';
      learnMoreButton.style.transition = 'all 0.3s ease';
      learnMoreButton.onmouseenter = function() {
        this.style.background = 'rgba(255, 87, 34, 0.15)';
        this.style.borderColor = 'rgba(255, 87, 34, 0.5)';
      };
      learnMoreButton.onmouseleave = function() {
        this.style.background = 'rgba(255, 87, 34, 0.1)';
        this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
      };
      learnMoreButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <span>Learn More</span>
        </div>
      `;
      learnMoreButton.addEventListener('click', function() {
        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
        toast.style.zIndex = '3000';
        toast.textContent = 'Opening Xapo Bank information...';
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 3000);
      });

      actionButtons.appendChild(applyButton);
      actionButtons.appendChild(learnMoreButton);
      body.appendChild(actionButtons);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeLoanModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Apply loan button functionality
    document.getElementById('applyLoanBtn').addEventListener('click', function() {
      showLoanCalculatorModal();
    });

    function showLoanCalculatorModal() {
      // Get current BTC price
      let currentBtcPrice = 50000; // Default fallback
      const btcPriceElement = document.getElementById('btc-price');
      if (btcPriceElement && btcPriceElement.textContent !== 'Loading...') {
        const priceText = btcPriceElement.textContent.replace('$', '').replace(/,/g, '');
        currentBtcPrice = parseFloat(priceText) || 50000;
      }

      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '800px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 22px; font-weight: bold; margin-bottom: 6px;">Loan Calculator</h2>
            <p style="color: #94a3b8; font-size: 13px;">Calculate your Bitcoin-backed loan amount</p>
          </div>
          <button id="closeCalculatorModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Currency Toggle Section
      const toggleSection = document.createElement('div');
      toggleSection.style.marginBottom = '24px';
      toggleSection.innerHTML = `
        <label style="display: block; color: #94a3b8; font-size: 13px; font-weight: 500; margin-bottom: 12px;">Select Input Currency</label>
        <div style="display: flex; gap: 12px;">
          <button id="toggleUSD" style="flex: 1; padding: 12px; border-radius: 12px; background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%); border: 2px solid #ff5722; color: #ffffff; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.3s ease;">
            USD ($)
          </button>
          <button id="toggleBTC" style="flex: 1; padding: 12px; border-radius: 12px; background: rgba(255, 87, 34, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #94a3b8; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.3s ease;">
            Bitcoin (BTC)
          </button>
        </div>
      `;
      body.appendChild(toggleSection);

      // Input Section
      const inputSection = document.createElement('div');
      inputSection.style.marginBottom = '24px';
      inputSection.innerHTML = `
        <label for="collateralInput" style="display: block; color: #94a3b8; font-size: 13px; font-weight: 500; margin-bottom: 12px;">Enter Collateral Amount</label>
        <div style="position: relative;">
          <input 
            type="number" 
            id="collateralInput" 
            placeholder="0.00" 
            min="0"
            step="any"
            style="width: 100%; padding: 14px 60px 14px 18px; border-radius: 12px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: 18px; font-weight: 600; outline: none; transition: all 0.3s ease;"
            onfocus="this.style.borderColor='#ff5722'"
            onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'"
          />
          <span id="currencyLabel" style="position: absolute; right: 18px; top: 50%; transform: translateY(-50%); color: #94a3b8; font-size: 14px; font-weight: 600;">USD</span>
        </div>
        <p style="color: #64748b; font-size: 12px; margin-top: 8px;">Current BTC Price: <span style="color: #10b981; font-weight: 600;">$${currentBtcPrice.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span></p>
      `;
      body.appendChild(inputSection);

      // Loan Amount Card
      const loanAmountCard = document.createElement('div');
      loanAmountCard.style.padding = '20px';
      loanAmountCard.style.marginBottom = '24px';
      loanAmountCard.style.borderRadius = '16px';
      loanAmountCard.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
      loanAmountCard.style.boxShadow = '0 8px 24px rgba(16, 185, 129, 0.3)';
      loanAmountCard.innerHTML = `
        <div style="text-align: center;">
          <p style="color: rgba(255, 255, 255, 0.9); font-size: 13px; margin-bottom: 8px;">You Can Borrow Up To</p>
          <p id="maxLoanAmount" style="color: #ffffff; font-size: 36px; font-weight: bold; margin-bottom: 6px;">$0.00</p>
          <p style="color: rgba(255, 255, 255, 0.8); font-size: 12px;">at 70% LTV (Loan-to-Value ratio)</p>
        </div>
      `;
      body.appendChild(loanAmountCard);

      // Total Payback Card (initially hidden)
      const paybackCard = document.createElement('div');
      paybackCard.id = 'totalPaybackCard';
      paybackCard.style.padding = '20px';
      paybackCard.style.marginBottom = '24px';
      paybackCard.style.borderRadius = '16px';
      paybackCard.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
      paybackCard.style.boxShadow = '0 8px 24px rgba(245, 158, 11, 0.3)';
      paybackCard.style.display = 'none';
      paybackCard.innerHTML = `
        <div style="text-align: center;">
          <p style="color: rgba(255, 255, 255, 0.9); font-size: 13px; margin-bottom: 8px;">Total Amount You'll Pay Back</p>
          <p id="totalPaybackAmount" style="color: #ffffff; font-size: 36px; font-weight: bold; margin-bottom: 8px;">$0.00</p>
          <div style="display: flex; justify-content: center; gap: 16px; margin-bottom: 6px;">
            <div>
              <p style="color: rgba(255, 255, 255, 0.8); font-size: 11px; margin-bottom: 2px;">Principal</p>
              <p id="principalAmount" style="color: #ffffff; font-size: 14px; font-weight: 600;">$0.00</p>
            </div>
            <div style="color: rgba(255, 255, 255, 0.6); font-size: 20px;">+</div>
            <div>
              <p style="color: rgba(255, 255, 255, 0.8); font-size: 11px; margin-bottom: 2px;">Interest</p>
              <p id="interestAmount" style="color: #ffffff; font-size: 14px; font-weight: 600;">$0.00</p>
            </div>
          </div>
          <p id="selectedTermInfo" style="color: rgba(255, 255, 255, 0.75); font-size: 12px;"></p>
        </div>
      `;
      body.appendChild(paybackCard);

      // Repayment Plans Section
      const repaymentSection = document.createElement('div');
      repaymentSection.style.marginBottom = '24px';
      repaymentSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 14px;">Select Repayment Term</h3>
      `;

      const repaymentPlans = [
        { days: 30, rate: 8.5, color: '#10b981' },
        { days: 90, rate: 9.5, color: '#6366f1' },
        { days: 180, rate: 10.5, color: '#f59e0b' },
        { days: 365, rate: 12.0, color: '#ef4444' }
      ];

      repaymentPlans.forEach((plan, index) => {
        const planCard = document.createElement('button');
        planCard.className = 'repayment-plan-card';
        planCard.dataset.days = plan.days;
        planCard.dataset.rate = plan.rate;
        planCard.style.width = '100%';
        planCard.style.padding = '20px';
        planCard.style.marginBottom = '12px';
        planCard.style.borderRadius = '12px';
        planCard.style.background = 'rgba(255, 87, 34, 0.05)';
        planCard.style.border = '2px solid rgba(255, 87, 34, 0.15)';
        planCard.style.cursor = 'pointer';
        planCard.style.transition = 'all 0.3s ease';
        planCard.style.textAlign = 'left';

        planCard.onmouseenter = function() {
          if (!this.classList.contains('selected')) {
            this.style.background = 'rgba(255, 87, 34, 0.1)';
            this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
          }
        };
        planCard.onmouseleave = function() {
          if (!this.classList.contains('selected')) {
            this.style.background = 'rgba(255, 87, 34, 0.05)';
            this.style.borderColor = 'rgba(255, 87, 34, 0.15)';
          }
        };

        planCard.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
            <div style="display: flex; align-items: center; gap: 12px;">
              <div style="width: 42px; height: 42px; border-radius: 10px; background: rgba(${plan.color === '#10b981' ? '16, 185, 129' : plan.color === '#6366f1' ? '99, 102, 241' : plan.color === '#f59e0b' ? '245, 158, 11' : '239, 68, 68'}, 0.15); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="${plan.color}" stroke-width="2.5">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
              </div>
              <div>
                <h4 style="color: #ffffff; font-size: 16px; font-weight: 700; margin-bottom: 3px;">${plan.days} Days</h4>
                <p style="color: #94a3b8; font-size: 12px;">${plan.days === 30 ? 'Short term' : plan.days === 90 ? 'Quarterly' : plan.days === 180 ? 'Semi-annual' : 'Annual'}</p>
              </div>
            </div>
            <div style="text-align: right;">
              <p style="color: ${plan.color}; font-size: 20px; font-weight: bold; margin-bottom: 2px;">${plan.rate}%</p>
              <p style="color: #64748b; font-size: 11px;">APR</p>
            </div>
          </div>
          <div class="plan-details" style="display: none; padding-top: 12px; border-top: 1px solid rgba(255, 87, 34, 0.2);">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div>
                <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Total Interest</p>
                <p class="total-interest" style="color: #ffffff; font-size: 14px; font-weight: 600;">$0.00</p>
              </div>
              <div>
                <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Total Repayment</p>
                <p class="total-repayment" style="color: #ffffff; font-size: 14px; font-weight: 600;">$0.00</p>
              </div>
            </div>
          </div>
        `;

        planCard.addEventListener('click', function() {
          // Remove selection from all cards
          document.querySelectorAll('.repayment-plan-card').forEach(card => {
            card.classList.remove('selected');
            card.style.background = 'rgba(255, 87, 34, 0.05)';
            card.style.borderColor = 'rgba(255, 87, 34, 0.15)';
          });

          // Select this card
          this.classList.add('selected');
          this.style.background = 'rgba(255, 87, 34, 0.15)';
          this.style.borderColor = '#ff5722';

          // Show details
          document.querySelectorAll('.plan-details').forEach(detail => {
            detail.style.display = 'none';
          });
          this.querySelector('.plan-details').style.display = 'block';

          // Update total payback card
          const totalRepaymentText = this.querySelector('.total-repayment').textContent;
          const totalInterestText = this.querySelector('.total-interest').textContent;
          const loanAmountText = document.getElementById('maxLoanAmount').textContent;
          
          document.getElementById('totalPaybackAmount').textContent = totalRepaymentText;
          document.getElementById('principalAmount').textContent = loanAmountText;
          document.getElementById('interestAmount').textContent = totalInterestText;
          document.getElementById('selectedTermInfo').textContent = `Over ${plan.days} days at ${plan.rate}% APR`;
          document.getElementById('totalPaybackCard').style.display = 'block';

          // Enable submit button
          document.getElementById('submitLoanBtn').disabled = false;
          document.getElementById('submitLoanBtn').style.opacity = '1';
          document.getElementById('submitLoanBtn').style.cursor = 'pointer';
        });

        repaymentSection.appendChild(planCard);
      });

      body.appendChild(repaymentSection);

      // Submit Button
      const submitButton = document.createElement('button');
      submitButton.id = 'submitLoanBtn';
      submitButton.disabled = true;
      submitButton.style.width = '100%';
      submitButton.style.padding = '16px';
      submitButton.style.borderRadius = '12px';
      submitButton.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      submitButton.style.border = 'none';
      submitButton.style.color = '#ffffff';
      submitButton.style.fontSize = '15px';
      submitButton.style.fontWeight = '700';
      submitButton.style.cursor = 'not-allowed';
      submitButton.style.transition = 'all 0.3s ease';
      submitButton.style.opacity = '0.5';
      submitButton.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      submitButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="12" y1="18" x2="12" y2="12"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
          <span>Continue with Loan Application</span>
        </div>
      `;

      submitButton.addEventListener('click', function() {
        if (!this.disabled) {
          const selectedPlan = document.querySelector('.repayment-plan-card.selected');
          const loanAmount = document.getElementById('maxLoanAmount').textContent;
          const days = selectedPlan.dataset.days;
          const rate = selectedPlan.dataset.rate;

          // Show withdrawal details modal
          showWithdrawalModal(loanAmount, days, rate);
          modal.remove();
        }
      });

      body.appendChild(submitButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Calculator Logic
      let isUSD = true;
      const usdToggle = document.getElementById('toggleUSD');
      const btcToggle = document.getElementById('toggleBTC');
      const collateralInput = document.getElementById('collateralInput');
      const currencyLabel = document.getElementById('currencyLabel');
      const maxLoanAmountElement = document.getElementById('maxLoanAmount');

      function updateToggleButtons() {
        if (isUSD) {
          usdToggle.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
          usdToggle.style.borderColor = '#ff5722';
          usdToggle.style.color = '#ffffff';
          
          btcToggle.style.background = 'rgba(255, 87, 34, 0.05)';
          btcToggle.style.borderColor = 'rgba(255, 87, 34, 0.2)';
          btcToggle.style.color = '#94a3b8';
          
          currencyLabel.textContent = 'USD';
          collateralInput.placeholder = '0.00';
        } else {
          btcToggle.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
          btcToggle.style.borderColor = '#ff5722';
          btcToggle.style.color = '#ffffff';
          
          usdToggle.style.background = 'rgba(255, 87, 34, 0.05)';
          usdToggle.style.borderColor = 'rgba(255, 87, 34, 0.2)';
          usdToggle.style.color = '#94a3b8';
          
          currencyLabel.textContent = 'BTC';
          collateralInput.placeholder = '0.00000000';
        }
      }

      function calculateLoan() {
        const inputValue = parseFloat(collateralInput.value) || 0;
        let collateralUSD = 0;

        if (isUSD) {
          collateralUSD = inputValue;
        } else {
          collateralUSD = inputValue * currentBtcPrice;
        }

        const maxLoan = collateralUSD * 0.7; // 70% LTV
        maxLoanAmountElement.textContent = '$' + maxLoan.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

        // Update all repayment plan details
        document.querySelectorAll('.repayment-plan-card').forEach(card => {
          const days = parseInt(card.dataset.days);
          const rate = parseFloat(card.dataset.rate);
          
          // Calculate interest (simple interest for the period)
          const interestAmount = (maxLoan * rate / 100) * (days / 365);
          const totalRepayment = maxLoan + interestAmount;
          
          card.querySelector('.total-interest').textContent = '$' + interestAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
          card.querySelector('.total-repayment').textContent = '$' + totalRepayment.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        });
      }

      usdToggle.addEventListener('click', function() {
        isUSD = true;
        updateToggleButtons();
        collateralInput.value = '';
        calculateLoan();
      });

      btcToggle.addEventListener('click', function() {
        isUSD = false;
        updateToggleButtons();
        collateralInput.value = '';
        calculateLoan();
      });

      collateralInput.addEventListener('input', calculateLoan);

      // Close modal functionality
      document.getElementById('closeCalculatorModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });

      // Initialize
      updateToggleButtons();
    }

    // Membership button functionality
    document.getElementById('membershipBtn').addEventListener('click', function() {
      showMembershipModal();
    });

    function showMembershipModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '700px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 24px; font-weight: bold; margin-bottom: 6px;">Xapo Bank Membership</h2>
            <p style="color: #94a3b8; font-size: 14px;">Premium banking with Bitcoin-backed loans</p>
          </div>
          <button id="closeMembershipModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Membership Status Card
      const statusCard = document.createElement('div');
      statusCard.style.padding = '24px';
      statusCard.style.marginBottom = '24px';
      statusCard.style.borderRadius = '16px';
      statusCard.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      statusCard.style.boxShadow = '0 8px 24px rgba(255, 87, 34, 0.4)';
      statusCard.innerHTML = `
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 20px;">
          <div style="width: 64px; height: 64px; border-radius: 16px; background: rgba(255, 255, 255, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2.5">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
            </svg>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #ffffff; font-size: 22px; font-weight: bold; margin-bottom: 6px;">Premium Member</h3>
            <div style="display: flex; align-items: center; gap: 8px;">
              <div style="width: 8px; height: 8px; border-radius: 50%; background: #10b981;"></div>
              <span style="color: rgba(255, 255, 255, 0.9); font-size: 14px; font-weight: 500;">Active</span>
            </div>
          </div>
        </div>
        <div style="background: rgba(255, 255, 255, 0.15); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: rgba(255, 255, 255, 0.85); font-size: 13px;">Annual Membership Fee</span>
            <span style="color: #ffffff; font-size: 20px; font-weight: bold;">$1,000</span>
          </div>
          <div style="color: rgba(255, 255, 255, 0.75); font-size: 12px; line-height: 1.5;">
            Auto-deducted annually when your account balance reaches $1,000 or equivalent in Bitcoin
          </div>
        </div>
        <div style="background: rgba(239, 68, 68, 0.15); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 10px; padding: 12px;">
          <div style="display: flex; gap: 10px; align-items: start;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#fca5a5" stroke-width="2" style="flex-shrink: 0; margin-top: 1px;">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="12"></line>
              <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <p style="color: #fca5a5; font-size: 12px; line-height: 1.5;">If your balance is insufficient, your account will be restricted until you add funds to cover the membership fee.</p>
          </div>
        </div>
      `;
      body.appendChild(statusCard);

      // Benefits Section
      const benefitsSection = document.createElement('div');
      benefitsSection.style.marginBottom = '24px';
      benefitsSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 18px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          Membership Benefits
        </h3>
      `;

      const benefits = [
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"></line>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
          </svg>`,
          title: 'USD & Bitcoin Accounts',
          description: 'Manage both fiat and cryptocurrency in one secure platform with seamless transfers between accounts.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 6v6l4 2"></path>
          </svg>`,
          title: 'Daily Interest Earnings',
          description: 'Earn competitive daily interest on both your Bitcoin and USD balances automatically.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
            <line x1="1" y1="10" x2="23" y2="10"></line>
          </svg>`,
          title: 'Bitcoin-Backed Loans',
          description: 'Borrow up to $1 million using your Bitcoin as collateral with flexible repayment terms and competitive rates.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>`,
          title: 'Premium 24/7 Support',
          description: 'Get dedicated priority assistance from our expert team whenever you need help, day or night.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>`,
          title: 'Top-Tier Security',
          description: 'Bank-grade security with cold storage for Bitcoin, insurance protection, and multi-factor authentication.'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="8 12 12 16 16 12"></polyline>
            <line x1="12" y1="8" x2="12" y2="16"></line>
          </svg>`,
          title: 'No Hidden Fees',
          description: 'Transparent pricing with the $1,000 annual fee covering all core services. No surprise charges or hidden costs.'
        }
      ];

      benefits.forEach(benefit => {
        const benefitItem = document.createElement('div');
        benefitItem.style.padding = '16px';
        benefitItem.style.marginBottom = '12px';
        benefitItem.style.borderRadius = '12px';
        benefitItem.style.background = 'rgba(16, 185, 129, 0.05)';
        benefitItem.style.border = '1px solid rgba(16, 185, 129, 0.2)';
        benefitItem.innerHTML = `
          <div style="display: flex; gap: 14px; align-items: start;">
            <div style="flex-shrink: 0; color: #10b981; margin-top: 2px;">
              ${benefit.icon}
            </div>
            <div style="flex: 1;">
              <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin-bottom: 6px;">${benefit.title}</h4>
              <p style="color: #94a3b8; font-size: 13px; line-height: 1.6;">${benefit.description}</p>
            </div>
          </div>
        `;
        benefitsSection.appendChild(benefitItem);
      });

      body.appendChild(benefitsSection);

      // Fee Details Section
      const feeSection = document.createElement('div');
      feeSection.style.marginBottom = '24px';
      feeSection.style.padding = '20px';
      feeSection.style.borderRadius = '12px';
      feeSection.style.background = 'rgba(99, 102, 241, 0.05)';
      feeSection.style.border = '1px solid rgba(99, 102, 241, 0.2)';
      feeSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 18px; font-weight: 600; margin-bottom: 14px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          How the Membership Fee Works
        </h3>
        <div style="space-y: 12px;">
          <div style="padding: 12px; background: rgba(99, 102, 241, 0.1); border-radius: 10px; margin-bottom: 10px;">
            <p style="color: #cbd5e1; font-size: 14px; line-height: 1.7;">
              <strong style="color: #ffffff;">Automatic Payment:</strong> The $1,000 annual fee is automatically deducted when your account balance (USD + Bitcoin equivalent) reaches at least $1,000.
            </p>
          </div>
          <div style="padding: 12px; background: rgba(99, 102, 241, 0.1); border-radius: 10px; margin-bottom: 10px;">
            <p style="color: #cbd5e1; font-size: 14px; line-height: 1.7;">
              <strong style="color: #ffffff;">Balance Requirement:</strong> You must maintain sufficient funds in your account for the fee deduction. The system checks both USD and Bitcoin balances (converted to USD at current market rates).
            </p>
          </div>
          <div style="padding: 12px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 10px;">
            <p style="color: #fca5a5; font-size: 14px; line-height: 1.7;">
              <strong style="color: #ef4444;">Account Restrictions:</strong> If your balance is insufficient to cover the annual fee, your account will be temporarily restricted until you add enough funds. During this time, certain features may be limited.
            </p>
          </div>
        </div>
      `;
      body.appendChild(feeSection);

      // Action Button
      const actionButton = document.createElement('button');
      actionButton.style.width = '100%';
      actionButton.style.padding = '16px';
      actionButton.style.borderRadius = '12px';
      actionButton.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      actionButton.style.border = 'none';
      actionButton.style.color = '#ffffff';
      actionButton.style.fontSize = '15px';
      actionButton.style.fontWeight = '700';
      actionButton.style.cursor = 'pointer';
      actionButton.style.transition = 'all 0.3s ease';
      actionButton.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      actionButton.onmouseenter = function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(255, 87, 34, 0.5)';
      };
      actionButton.onmouseleave = function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      };
      actionButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
          </svg>
          <span>View Full Terms & Conditions</span>
        </div>
      `;
      actionButton.addEventListener('click', function() {
        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
        toast.style.zIndex = '3000';
        toast.textContent = 'Opening Xapo Bank terms...';
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 3000);
      });

      body.appendChild(actionButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeMembershipModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Profile button functionality
    document.getElementById('profileBtn').addEventListener('click', function() {
      showProfileModal();
    });

    function showProfileModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '700px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 24px; font-weight: bold; margin-bottom: 4px;">User Profile</h2>
            <p style="color: #94a3b8; font-size: 14px;">Your account information</p>
          </div>
          <button id="closeProfileModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Profile Header Card
      const profileCard = document.createElement('div');
      profileCard.style.padding = '24px';
      profileCard.style.marginBottom = '24px';
      profileCard.style.borderRadius = '16px';
      profileCard.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      profileCard.style.boxShadow = '0 8px 24px rgba(255, 87, 34, 0.4)';
      profileCard.innerHTML = `
        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
          <div style="width: 80px; height: 80px; border-radius: 50%; background: rgba(255, 255, 255, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: 3px solid rgba(255, 255, 255, 0.3);">
            <span style="color: #ffffff; font-size: 32px; font-weight: bold;">JD</span>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #ffffff; font-size: 22px; font-weight: bold; margin-bottom: 6px;">John Doe</h3>
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
              <div style="background: rgba(255, 255, 255, 0.2); padding: 4px 12px; border-radius: 20px; display: flex; align-items: center; gap: 6px;">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2.5">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                </svg>
                <span style="color: #ffffff; font-size: 12px; font-weight: 600;">Premium Member</span>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
              <div style="width: 10px; height: 10px; border-radius: 50%; background: #10b981;"></div>
              <span style="color: rgba(255, 255, 255, 0.9); font-size: 13px;">Active Account</span>
            </div>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">Member Since</div>
            <div style="color: #ffffff; font-size: 16px; font-weight: bold;">Jan 2024</div>
          </div>
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">Total Loans</div>
            <div style="color: #ffffff; font-size: 16px; font-weight: bold;">3</div>
          </div>
          <div style="background: rgba(255, 255, 255, 0.15); padding: 14px; border-radius: 10px;">
            <div style="color: rgba(255, 255, 255, 0.8); font-size: 12px; margin-bottom: 4px;">Credit Score</div>
            <div style="color: #ffffff; font-size: 16px; font-weight: bold;">Excellent</div>
          </div>
        </div>
      `;
      body.appendChild(profileCard);

      // Personal Information Section
      const personalSection = document.createElement('div');
      personalSection.style.marginBottom = '24px';
      personalSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          Personal Information
        </h3>
      `;

      // Store for profile data
      const profileData = {
        fullName: 'John Doe',
        email: 'john.doe@example.com',
        phone: '+1 (555) 123-4567',
        country: 'United States',
        address: '123 Main Street, New York, NY 10001'
      };

      const personalInfo = [
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>`,
          label: 'Full Name',
          field: 'fullName',
          value: profileData.fullName,
          editable: true
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
            <polyline points="22,6 12,13 2,6"></polyline>
          </svg>`,
          label: 'Email Address',
          field: 'email',
          value: profileData.email,
          editable: true
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
          </svg>`,
          label: 'Phone Number',
          field: 'phone',
          value: profileData.phone,
          editable: true
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="10" r="3"></circle>
            <path d="M12 21.7C17.3 17 20 13 20 10a8 8 0 1 0-16 0c0 3 2.7 7 8 11.7z"></path>
          </svg>`,
          label: 'Country',
          field: 'country',
          value: profileData.country,
          editable: true
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>`,
          label: 'Address',
          field: 'address',
          value: profileData.address,
          editable: true
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>`,
          label: 'Date of Birth',
          value: 'January 15, 1990',
          editable: false
        }
      ];

      personalInfo.forEach(info => {
        const infoItem = document.createElement('div');
        infoItem.className = 'info-item';
        infoItem.dataset.field = info.field;
        infoItem.style.padding = '16px';
        infoItem.style.marginBottom = '12px';
        infoItem.style.borderRadius = '12px';
        infoItem.style.background = 'rgba(255, 87, 34, 0.05)';
        infoItem.style.border = '1px solid rgba(255, 87, 34, 0.15)';
        
        const displayMode = `
          <div style="display: flex; align-items: center; justify-content: between; gap: 14px;" class="display-mode">
            <div style="color: #ff5722; flex-shrink: 0;">
              ${info.icon}
            </div>
            <div style="flex: 1;">
              <div style="color: #64748b; font-size: 12px; margin-bottom: 4px;">${info.label}</div>
              <div class="value-display" style="color: #ffffff; font-size: 14px; font-weight: 500;">${info.value}</div>
            </div>
            ${info.editable ? `
              <button class="edit-btn" style="background: rgba(255, 87, 34, 0.1); border: 1px solid rgba(255, 87, 34, 0.3); padding: 8px 12px; border-radius: 8px; color: #ff5722; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; flex-shrink: 0;" onmouseover="this.style.background='rgba(255, 87, 34, 0.15)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
                Edit
              </button>
            ` : ''}
          </div>
        `;

        const editMode = info.editable ? `
          <div style="display: none;" class="edit-mode">
            <div style="margin-bottom: 12px;">
              <label style="display: block; color: #64748b; font-size: 12px; margin-bottom: 8px;">${info.label}</label>
              <input type="text" class="edit-input" value="${info.value}" style="width: 100%; padding: 10px 12px; border-radius: 8px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: 14px; outline: none;" onfocus="this.style.borderColor='#ff5722'" onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'">
            </div>
            <div style="display: flex; gap: 8px;">
              <button class="save-btn" style="flex: 1; padding: 10px; border-radius: 8px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; color: #ffffff; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                Save
              </button>
              <button class="cancel-btn" style="flex: 1; padding: 10px; border-radius: 8px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: #ef4444; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(239, 68, 68, 0.15)'" onmouseout="this.style.background='rgba(239, 68, 68, 0.1)'">
                Cancel
              </button>
            </div>
          </div>
        ` : '';

        infoItem.innerHTML = displayMode + editMode;
        
        if (info.editable) {
          const editBtn = infoItem.querySelector('.edit-btn');
          const saveBtn = infoItem.querySelector('.save-btn');
          const cancelBtn = infoItem.querySelector('.cancel-btn');
          const displayMode = infoItem.querySelector('.display-mode');
          const editMode = infoItem.querySelector('.edit-mode');
          const editInput = infoItem.querySelector('.edit-input');
          const valueDisplay = infoItem.querySelector('.value-display');

          editBtn.addEventListener('click', function() {
            displayMode.style.display = 'none';
            editMode.style.display = 'block';
            editInput.focus();
          });

          cancelBtn.addEventListener('click', function() {
            editInput.value = info.value;
            editMode.style.display = 'none';
            displayMode.style.display = 'flex';
          });

          saveBtn.addEventListener('click', function() {
            const newValue = editInput.value.trim();
            if (newValue && newValue !== info.value) {
              info.value = newValue;
              profileData[info.field] = newValue;
              valueDisplay.textContent = newValue;
              
              // Show success toast
              const toast = document.createElement('div');
              toast.style.position = 'fixed';
              toast.style.bottom = '24px';
              toast.style.right = '24px';
              toast.style.padding = '12px 20px';
              toast.style.borderRadius = '10px';
              toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
              toast.style.color = '#ffffff';
              toast.style.fontWeight = '600';
              toast.style.fontSize = '13px';
              toast.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.4)';
              toast.style.zIndex = '3000';
              toast.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                  <span>${info.label} updated successfully!</span>
                </div>
              `;
              document.body.appendChild(toast);

              setTimeout(() => {
                toast.remove();
              }, 3000);
            }
            editMode.style.display = 'none';
            displayMode.style.display = 'flex';
          });

          // Allow Enter key to save
          editInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
              saveBtn.click();
            }
          });

          // Allow Escape key to cancel
          editInput.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
              cancelBtn.click();
            }
          });
        }

        personalSection.appendChild(infoItem);
      });

      body.appendChild(personalSection);

      // Account Details Section
      const accountSection = document.createElement('div');
      accountSection.style.marginBottom = '24px';
      accountSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
          </svg>
          Account Details
        </h3>
      `;

      const accountInfo = [
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
          </svg>`,
          label: 'User ID',
          value: 'CL-2024-789456',
          copyable: true
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
            <line x1="1" y1="10" x2="23" y2="10"></line>
          </svg>`,
          label: 'Account Type',
          value: 'Premium Membership',
          badge: true,
          badgeColor: '#f59e0b'
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>`,
          label: 'KYC Status',
          value: 'Verified',
          badge: true,
          badgeColor: '#10b981'
        },
        {
          icon: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>`,
          label: 'Account Status',
          value: 'Active & In Good Standing',
          badge: true,
          badgeColor: '#10b981'
        }
      ];

      accountInfo.forEach(info => {
        const infoItem = document.createElement('div');
        infoItem.style.padding = '16px';
        infoItem.style.marginBottom = '12px';
        infoItem.style.borderRadius = '12px';
        infoItem.style.background = 'rgba(99, 102, 241, 0.05)';
        infoItem.style.border = '1px solid rgba(99, 102, 241, 0.15)';
        infoItem.innerHTML = `
          <div style="display: flex; align-items: center; gap: 14px;">
            <div style="color: #6366f1; flex-shrink: 0;">
              ${info.icon}
            </div>
            <div style="flex: 1;">
              <div style="color: #64748b; font-size: 12px; margin-bottom: 4px;">${info.label}</div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="color: #ffffff; font-size: 14px; font-weight: 500;">${info.value}</span>
                ${info.badge ? `
                  <span style="display: inline-flex; align-items: center; gap: 4px; background: ${info.badgeColor}20; color: ${info.badgeColor}; font-size: 10px; padding: 3px 8px; border-radius: 12px; font-weight: 600;">
                    <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    ${info.value.split(' ')[0]}
                  </span>
                ` : ''}
              </div>
            </div>
            ${info.copyable ? `
              <button class="copy-btn" data-copy="${info.value}" style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); padding: 8px 12px; border-radius: 8px; color: #6366f1; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; flex-shrink: 0;" onmouseover="this.style.background='rgba(99, 102, 241, 0.15)'" onmouseout="this.style.background='rgba(99, 102, 241, 0.1)'">
                Copy
              </button>
            ` : ''}
          </div>
        `;
        accountSection.appendChild(infoItem);
      });

      body.appendChild(accountSection);

      // Verification Documents Section
      const documentsSection = document.createElement('div');
      documentsSection.style.marginBottom = '24px';
      documentsSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="12" y1="18" x2="12" y2="12"></line>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
          Verification Documents
        </h3>
      `;

      const documents = [
        { name: 'Government ID', status: 'Verified', date: 'Jan 10, 2024', color: '#10b981' },
        { name: 'Proof of Address', status: 'Verified', date: 'Jan 12, 2024', color: '#10b981' },
        { name: 'Selfie Verification', status: 'Verified', date: 'Jan 10, 2024', color: '#10b981' }
      ];

      documents.forEach(doc => {
        const docItem = document.createElement('div');
        docItem.style.padding = '14px';
        docItem.style.marginBottom = '10px';
        docItem.style.borderRadius = '12px';
        docItem.style.background = 'rgba(16, 185, 129, 0.05)';
        docItem.style.border = '1px solid rgba(16, 185, 129, 0.15)';
        docItem.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 12px;">
              <div style="width: 36px; height: 36px; border-radius: 8px; background: ${doc.color}20; display: flex; align-items: center; justify-content: center;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="${doc.color}" stroke-width="2.5">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </div>
              <div>
                <div style="color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 2px;">${doc.name}</div>
                <div style="color: #64748b; font-size: 12px;">${doc.date}</div>
              </div>
            </div>
            <div style="background: ${doc.color}20; color: ${doc.color}; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">
              ${doc.status}
            </div>
          </div>
        `;
        documentsSection.appendChild(docItem);
      });

      body.appendChild(documentsSection);

      // Action Buttons
      const actionsSection = document.createElement('div');
      actionsSection.style.display = 'grid';
      actionsSection.style.gridTemplateColumns = 'repeat(auto-fit, minmax(200px, 1fr))';
      actionsSection.style.gap = '12px';
      actionsSection.style.marginTop = '24px';

      const editProfileBtn = document.createElement('button');
      editProfileBtn.style.padding = '14px';
      editProfileBtn.style.borderRadius = '12px';
      editProfileBtn.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      editProfileBtn.style.border = 'none';
      editProfileBtn.style.color = '#ffffff';
      editProfileBtn.style.fontSize = '14px';
      editProfileBtn.style.fontWeight = '600';
      editProfileBtn.style.cursor = 'pointer';
      editProfileBtn.style.transition = 'all 0.3s ease';
      editProfileBtn.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
          <span>Edit Profile</span>
        </div>
      `;
      editProfileBtn.onmouseenter = function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(255, 87, 34, 0.5)';
      };
      editProfileBtn.onmouseleave = function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = 'none';
      };
      editProfileBtn.onclick = function() {
        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
        toast.style.zIndex = '3000';
        toast.textContent = 'Edit profile functionality coming soon!';
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      };

      const downloadDataBtn = document.createElement('button');
      downloadDataBtn.style.padding = '14px';
      downloadDataBtn.style.borderRadius = '12px';
      downloadDataBtn.style.background = 'rgba(99, 102, 241, 0.1)';
      downloadDataBtn.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      downloadDataBtn.style.color = '#6366f1';
      downloadDataBtn.style.fontSize = '14px';
      downloadDataBtn.style.fontWeight = '600';
      downloadDataBtn.style.cursor = 'pointer';
      downloadDataBtn.style.transition = 'all 0.3s ease';
      downloadDataBtn.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          <span>Download Data</span>
        </div>
      `;
      downloadDataBtn.onmouseenter = function() {
        this.style.background = 'rgba(99, 102, 241, 0.15)';
        this.style.borderColor = 'rgba(99, 102, 241, 0.5)';
      };
      downloadDataBtn.onmouseleave = function() {
        this.style.background = 'rgba(99, 102, 241, 0.1)';
        this.style.borderColor = 'rgba(99, 102, 241, 0.3)';
      };
      downloadDataBtn.onclick = function() {
        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
        toast.style.zIndex = '3000';
        toast.textContent = 'Preparing your data for download...';
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      };

      actionsSection.appendChild(editProfileBtn);
      actionsSection.appendChild(downloadDataBtn);
      body.appendChild(actionsSection);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Copy button functionality
      document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const textToCopy = this.dataset.copy;
          navigator.clipboard.writeText(textToCopy).then(() => {
            const originalText = this.textContent;
            this.textContent = 'Copied!';
            this.style.background = 'rgba(16, 185, 129, 0.15)';
            this.style.borderColor = '#10b981';
            this.style.color = '#10b981';

            setTimeout(() => {
              this.textContent = originalText;
              this.style.background = 'rgba(99, 102, 241, 0.1)';
              this.style.borderColor = 'rgba(99, 102, 241, 0.3)';
              this.style.color = '#6366f1';
            }, 2000);
          });
        });
      });

      // Close modal functionality
      document.getElementById('closeProfileModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Sample transaction data
    const transactions = [
      {
        type: 'deposit',
        amount: '$2,500.00',
        crypto: '0.05 BTC',
        date: '2024-01-15',
        time: '14:32',
        status: 'completed'
      },
      {
        type: 'loan',
        amount: '$10,000.00',
        crypto: '0.20 BTC',
        date: '2024-01-10',
        time: '09:15',
        status: 'completed'
      },
      {
        type: 'withdrawal',
        amount: '$1,200.00',
        crypto: '0.025 BTC',
        date: '2024-01-08',
        time: '16:45',
        status: 'completed'
      },
      {
        type: 'payment',
        amount: '$500.00',
        crypto: '0.01 BTC',
        date: '2024-01-05',
        time: '11:20',
        status: 'completed'
      },
      {
        type: 'deposit',
        amount: '$5,000.00',
        crypto: '0.10 BTC',
        date: '2024-01-01',
        time: '08:30',
        status: 'completed'
      }
    ];

    // Withdrawal Modal Function
    function showWithdrawalModal(loanAmount, days, rate) {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 22px; font-weight: bold; margin-bottom: 6px;">Withdrawal Details</h2>
            <p style="color: #94a3b8; font-size: 13px;">Enter your Bitcoin wallet address to receive funds</p>
          </div>
          <button id="closeWithdrawalModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Loan Summary Card
      const summaryCard = document.createElement('div');
      summaryCard.style.padding = '20px';
      summaryCard.style.marginBottom = '24px';
      summaryCard.style.borderRadius = '16px';
      summaryCard.style.background = 'rgba(99, 102, 241, 0.1)';
      summaryCard.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      summaryCard.innerHTML = `
        <h3 style="color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 16px;">Loan Summary</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
          <div>
            <p style="color: #94a3b8; font-size: 12px; margin-bottom: 4px;">Loan Amount</p>
            <p style="color: #ffffff; font-size: 18px; font-weight: bold;">${loanAmount}</p>
          </div>
          <div>
            <p style="color: #94a3b8; font-size: 12px; margin-bottom: 4px;">Interest Rate</p>
            <p style="color: #10b981; font-size: 18px; font-weight: bold;">${rate}% APR</p>
          </div>
          <div>
            <p style="color: #94a3b8; font-size: 12px; margin-bottom: 4px;">Loan Term</p>
            <p style="color: #ffffff; font-size: 18px; font-weight: bold;">${days} Days</p>
          </div>
          <div>
            <p style="color: #94a3b8; font-size: 12px; margin-bottom: 4px;">Withdrawal Method</p>
            <p style="color: #f59e0b; font-size: 18px; font-weight: bold;">BTC</p>
          </div>
        </div>
      `;
      body.appendChild(summaryCard);

      // Withdrawal Method Notice
      const methodNotice = document.createElement('div');
      methodNotice.style.padding = '16px';
      methodNotice.style.marginBottom = '24px';
      methodNotice.style.borderRadius = '12px';
      methodNotice.style.background = 'rgba(245, 158, 11, 0.1)';
      methodNotice.style.border = '1px solid rgba(245, 158, 11, 0.3)';
      methodNotice.innerHTML = `
        <div style="display: flex; gap: 12px; align-items: start;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          <div>
            <h4 style="color: #f59e0b; font-size: 14px; font-weight: 600; margin-bottom: 6px;">BTC Withdrawal Only</h4>
            <p style="color: #cbd5e1; font-size: 13px; line-height: 1.6;">Your loan will be disbursed directly to your Bitcoin wallet address. Make sure you have access to this wallet before proceeding.</p>
          </div>
        </div>
      `;
      body.appendChild(methodNotice);

      // BTC Address Input Section
      const addressSection = document.createElement('div');
      addressSection.style.marginBottom = '24px';
      addressSection.innerHTML = `
        <label for="btcAddress" style="display: block; color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 12px;">
          Bitcoin Wallet Address
          <span style="color: #ef4444; margin-left: 4px;">*</span>
        </label>
        <input 
          type="text" 
          id="btcAddress" 
          placeholder="Enter your BTC wallet address (e.g., bc1q...)" 
          style="width: 100%; padding: 14px 16px; border-radius: 12px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); color: #ffffff; font-size: 14px; font-family: monospace; outline: none; transition: all 0.3s ease; margin-bottom: 8px;"
          onfocus="this.style.borderColor='#ff5722'"
          onblur="this.style.borderColor='rgba(255, 87, 34, 0.2)'"
        />
        <p style="color: #64748b; font-size: 12px; margin-bottom: 16px;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle; margin-right: 4px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          Supported formats: Legacy (1...), SegWit (3...), and Native SegWit (bc1...)
        </p>
      `;
      body.appendChild(addressSection);

      // Confirmation Checkbox
      const confirmSection = document.createElement('div');
      confirmSection.style.marginBottom = '24px';
      confirmSection.innerHTML = `
        <label style="display: flex; align-items: start; gap: 12px; cursor: pointer; padding: 16px; border-radius: 12px; background: rgba(255, 87, 34, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); transition: all 0.3s ease;" id="confirmLabel">
          <input 
            type="checkbox" 
            id="confirmAddress" 
            style="width: 20px; height: 20px; cursor: pointer; margin-top: 2px; accent-color: #ff5722; flex-shrink: 0;"
          />
          <span style="color: #cbd5e1; font-size: 13px; line-height: 1.6;">
            I confirm that I have <strong style="color: #ffffff;">double-checked</strong> my Bitcoin wallet address and understand that I have full access to this wallet. I acknowledge that this address is correct and belongs to me.
          </span>
        </label>
      `;
      body.appendChild(confirmSection);

      // Warning Alert
      const warningAlert = document.createElement('div');
      warningAlert.style.padding = '20px';
      warningAlert.style.marginBottom = '24px';
      warningAlert.style.borderRadius = '12px';
      warningAlert.style.background = 'rgba(239, 68, 68, 0.1)';
      warningAlert.style.border = '2px solid rgba(239, 68, 68, 0.4)';
      warningAlert.innerHTML = `
        <div style="display: flex; gap: 14px; align-items: start;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2.5" style="flex-shrink: 0;">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <div>
            <h4 style="color: #ef4444; font-size: 15px; font-weight: 700; margin-bottom: 8px;">⚠���� CRITICAL WARNING - READ CAREFULLY</h4>
            <ul style="color: #fca5a5; font-size: 13px; line-height: 1.8; margin: 0; padding-left: 20px;">
              <li style="margin-bottom: 6px;"><strong style="color: #ffffff;">Transactions are IRREVERSIBLE:</strong> Once funds are sent, they CANNOT be recovered if sent to wrong address</li>
              <li style="margin-bottom: 6px;"><strong style="color: #ffffff;">Verify your address:</strong> Triple-check every character of your wallet address before submitting</li>
              <li style="margin-bottom: 6px;"><strong style="color: #ffffff;">No recovery possible:</strong> We cannot reverse, cancel, or recover funds sent to an incorrect address</li>
              <li><strong style="color: #ffffff;">Your responsibility:</strong> You are solely responsible for ensuring the address is correct and accessible</li>
            </ul>
          </div>
        </div>
      `;
      body.appendChild(warningAlert);

      // Submit Button
      const submitButton = document.createElement('button');
      submitButton.id = 'submitWithdrawal';
      submitButton.disabled = true;
      submitButton.style.width = '100%';
      submitButton.style.padding = '16px';
      submitButton.style.borderRadius = '12px';
      submitButton.style.background = 'linear-gradient(135deg, #ff5722 0%, #ff7043 100%)';
      submitButton.style.border = 'none';
      submitButton.style.color = '#ffffff';
      submitButton.style.fontSize = '15px';
      submitButton.style.fontWeight = '700';
      submitButton.style.cursor = 'not-allowed';
      submitButton.style.transition = 'all 0.3s ease';
      submitButton.style.opacity = '0.5';
      submitButton.style.boxShadow = '0 4px 12px rgba(255, 87, 34, 0.3)';
      submitButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          <span>Confirm & Submit Loan Application</span>
        </div>
      `;

      body.appendChild(submitButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Form validation
      const btcAddressInput = document.getElementById('btcAddress');
      const confirmCheckbox = document.getElementById('confirmAddress');
      const confirmLabel = document.getElementById('confirmLabel');

      function validateForm() {
        const address = btcAddressInput.value.trim();
        const isChecked = confirmCheckbox.checked;
        
        // Basic BTC address validation (simplified)
        const isValidFormat = /^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,62}$/.test(address);
        
        if (isValidFormat && isChecked) {
          submitButton.disabled = false;
          submitButton.style.opacity = '1';
          submitButton.style.cursor = 'pointer';
          btcAddressInput.style.borderColor = '#10b981';
        } else {
          submitButton.disabled = true;
          submitButton.style.opacity = '0.5';
          submitButton.style.cursor = 'not-allowed';
          if (address.length > 0 && !isValidFormat) {
            btcAddressInput.style.borderColor = '#ef4444';
          }
        }
      }

      btcAddressInput.addEventListener('input', validateForm);
      confirmCheckbox.addEventListener('change', function() {
        validateForm();
        if (this.checked) {
          confirmLabel.style.background = 'rgba(16, 185, 129, 0.1)';
          confirmLabel.style.borderColor = '#10b981';
        } else {
          confirmLabel.style.background = 'rgba(255, 87, 34, 0.05)';
          confirmLabel.style.borderColor = 'rgba(255, 87, 34, 0.2)';
        }
      });

      // Submit button click
      submitButton.addEventListener('click', function() {
        if (!this.disabled) {
          const btcAddress = btcAddressInput.value.trim();
          
          // Create processing overlay on the modal
          const processingOverlay = document.createElement('div');
          processingOverlay.style.position = 'absolute';
          processingOverlay.style.top = '0';
          processingOverlay.style.left = '0';
          processingOverlay.style.right = '0';
          processingOverlay.style.bottom = '0';
          processingOverlay.style.background = 'rgba(0, 0, 0, 0.9)';
          processingOverlay.style.borderRadius = '24px';
          processingOverlay.style.display = 'flex';
          processingOverlay.style.alignItems = 'center';
          processingOverlay.style.justifyContent = 'center';
          processingOverlay.style.zIndex = '10';
          processingOverlay.innerHTML = `
            <div style="text-align: center; padding: 40px;">
              <div style="width: 64px; height: 64px; border: 4px solid rgba(255, 87, 34, 0.2); border-top-color: #ff5722; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
              <h3 style="color: #ffffff; font-size: 20px; font-weight: 700; margin-bottom: 8px;">Processing Your Loan Application</h3>
              <p style="color: #94a3b8; font-size: 14px; margin-bottom: 20px;">Please wait while we verify your details...</p>
              <div id="processingSteps" style="text-align: left; max-width: 320px; margin: 0 auto;">
                <div class="step-item" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
                  <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
                  </div>
                  <span style="color: #94a3b8; font-size: 13px;">Verifying collateral</span>
                </div>
                <div class="step-item" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
                  <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
                  </div>
                  <span style="color: #94a3b8; font-size: 13px;">Calculating loan terms</span>
                </div>
                <div class="step-item" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
                  <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
                  </div>
                  <span style="color: #94a3b8; font-size: 13px;">Validating Bitcoin address</span>
                </div>
                <div class="step-item" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
                  <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
                  </div>
                  <span style="color: #94a3b8; font-size: 13px;">Preparing disbursement</span>
                </div>
              </div>
            </div>
            <style>
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            </style>
          `;
          
          modalContent.style.position = 'relative';
          modalContent.appendChild(processingOverlay);

          // Animate steps
          const steps = processingOverlay.querySelectorAll('.step-item');
          let currentStep = 0;
          
          const animateStep = () => {
            if (currentStep < steps.length) {
              const step = steps[currentStep];
              step.style.opacity = '1';
              const icon = step.querySelector('.step-icon');
              icon.style.borderColor = '#ff5722';
              icon.querySelector('div').style.background = '#ff5722';
              
              setTimeout(() => {
                // Show checkmark
                icon.innerHTML = `
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                `;
                icon.style.background = '#10b981';
                icon.style.borderColor = '#10b981';
                
                currentStep++;
                if (currentStep < steps.length) {
                  setTimeout(animateStep, 600);
                } else {
                  // All steps complete, show success
                  setTimeout(() => {
                    processingOverlay.innerHTML = `
                      <div style="text-align: center; padding: 40px;">
                        <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #10b981 0%, #059669 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);">
                          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3">
                            <polyline points="20 6 9 17 4 12"></polyline>
                          </svg>
                        </div>
                        <h3 style="color: #ffffff; font-size: 24px; font-weight: 700; margin-bottom: 12px;">Loan Approved!</h3>
                        <p style="color: #10b981; font-size: 16px; font-weight: 600; margin-bottom: 8px;">${loanAmount}</p>
                        <p style="color: #94a3b8; font-size: 14px; margin-bottom: 20px;">will be sent to your Bitcoin wallet</p>
                        
                        <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 16px; margin-bottom: 24px; text-align: left;">
                          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                            <div>
                              <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Loan Amount</p>
                              <p style="color: #ffffff; font-size: 14px; font-weight: 600;">${loanAmount}</p>
                            </div>
                            <div>
                              <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Interest Rate</p>
                              <p style="color: #ffffff; font-size: 14px; font-weight: 600;">${rate}% APR</p>
                            </div>
                            <div>
                              <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Loan Term</p>
                              <p style="color: #ffffff; font-size: 14px; font-weight: 600;">${days} days</p>
                            </div>
                            <div>
                              <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Loan ID</p>
                              <p style="color: #ffffff; font-size: 14px; font-weight: 600;">#${Math.random().toString(36).substr(2, 9).toUpperCase()}</p>
                            </div>
                          </div>
                          <div style="padding-top: 12px; border-top: 1px solid rgba(16, 185, 129, 0.2);">
                            <p style="color: #64748b; font-size: 11px; margin-bottom: 4px;">Withdrawal Address</p>
                            <p style="color: #ffffff; font-size: 12px; font-family: monospace; word-break: break-all;">${btcAddress}</p>
                          </div>
                        </div>
                        
                        <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 12px; padding: 12px; margin-bottom: 20px;">
                          <div style="display: flex; gap: 10px; align-items: start;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
                              <circle cx="12" cy="12" r="10"></circle>
                              <line x1="12" y1="16" x2="12" y2="12"></line>
                              <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                            <div style="flex: 1; text-align: left;">
                              <p style="color: #cbd5e1; font-size: 12px; line-height: 1.5;">Your Bitcoin will be disbursed within 30-60 minutes once the transaction is confirmed on the blockchain. You'll receive an email notification.</p>
                            </div>
                          </div>
                        </div>
                        
                        <button id="closeSuccessModal" style="width: 100%; padding: 16px; border-radius: 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; color: #ffffff; font-size: 15px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
                          Return to Dashboard
                        </button>
                      </div>
                    `;
                    
                    // Add close button functionality
                    document.getElementById('closeSuccessModal').addEventListener('click', function() {
                      // Show success toast
                      const toast = document.createElement('div');
                      toast.style.position = 'fixed';
                      toast.style.bottom = '24px';
                      toast.style.right = '24px';
                      toast.style.padding = '16px 24px';
                      toast.style.borderRadius = '12px';
                      toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                      toast.style.color = '#ffffff';
                      toast.style.fontWeight = '600';
                      toast.style.fontSize = '14px';
                      toast.style.boxShadow = '0 8px 24px rgba(16, 185, 129, 0.5)';
                      toast.style.zIndex = '3000';
                      toast.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 10px;">
                          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                            <polyline points="20 6 9 17 4 12"></polyline>
                          </svg>
                          <span>Loan application successful! Check your email for details.</span>
                        </div>
                      `;
                      document.body.appendChild(toast);

                      setTimeout(() => {
                        toast.remove();
                      }, 5000);

                      modal.remove();
                    });
                  }, 800);
                }
              }, 800);
            }
          };
          
          // Start animation after a brief delay
          setTimeout(animateStep, 500);
        }
      });

      // Close modal functionality
      document.getElementById('closeWithdrawalModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Sidebar Activity button functionality
    document.getElementById('sidebarActivityBtn').addEventListener('click', function(e) {
      e.preventDefault();
      showActivityModal();
    });

    function showActivityModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '700px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 24px; font-weight: bold; margin-bottom: 4px;">Transaction History</h2>
            <p style="color: #94a3b8; font-size: 14px;">Your recent activity and transactions</p>
          </div>
          <button id="closeActivityModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Generate transaction items
      transactions.forEach((transaction, index) => {
        const transactionItem = document.createElement('div');
        transactionItem.style.padding = '16px';
        transactionItem.style.marginBottom = '12px';
        transactionItem.style.borderRadius = '12px';
        transactionItem.style.background = 'rgba(255, 87, 34, 0.05)';
        transactionItem.style.border = '1px solid rgba(255, 87, 34, 0.15)';
        transactionItem.style.transition = 'all 0.3s ease';
        transactionItem.style.cursor = 'pointer';
        transactionItem.onmouseenter = function() {
          this.style.background = 'rgba(255, 87, 34, 0.1)';
          this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
        };
        transactionItem.onmouseleave = function() {
          this.style.background = 'rgba(255, 87, 34, 0.05)';
          this.style.borderColor = 'rgba(255, 87, 34, 0.15)';
        };

        let iconColor, iconBg, typeLabel;
        if (transaction.type === 'deposit') {
          iconColor = '#10b981';
          iconBg = 'rgba(16, 185, 129, 0.15)';
          typeLabel = 'Deposit';
        } else if (transaction.type === 'withdrawal') {
          iconColor = '#ef4444';
          iconBg = 'rgba(239, 68, 68, 0.15)';
          typeLabel = 'Withdrawal';
        } else if (transaction.type === 'loan') {
          iconColor = '#6366f1';
          iconBg = 'rgba(99, 102, 241, 0.15)';
          typeLabel = 'Loan Issued';
        } else if (transaction.type === 'payment') {
          iconColor = '#f59e0b';
          iconBg = 'rgba(245, 158, 11, 0.15)';
          typeLabel = 'Payment';
        }

        transactionItem.innerHTML = `
          <div style="display: flex; align-items: center; gap: 16px;">
            <div style="width: 48px; height: 48px; border-radius: 12px; background: ${iconBg}; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
              ${transaction.type === 'deposit' ? `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="2">
                  <line x1="12" y1="19" x2="12" y2="5"></line>
                  <polyline points="5 12 12 5 19 12"></polyline>
                </svg>
              ` : transaction.type === 'withdrawal' ? `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <polyline points="19 12 12 19 5 12"></polyline>
                </svg>
              ` : transaction.type === 'loan' ? `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="2">
                  <line x1="12" y1="1" x2="12" y2="23"></line>
                  <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
              ` : `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
              `}
            </div>
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                <h3 style="color: #ffffff; font-size: 16px; font-weight: 600;">${typeLabel}</h3>
                <span style="color: #ffffff; font-size: 16px; font-weight: bold;">${transaction.amount}</span>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span style="color: #64748b; font-size: 13px;">${transaction.date} at ${transaction.time}</span>
                <span style="color: #4a9b8e; font-size: 13px;">${transaction.crypto}</span>
              </div>
            </div>
            <div style="flex-shrink: 0;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="2">
                <path d="M9 18l6-6-6-6"></path>
              </svg>
            </div>
          </div>
        `;

        body.appendChild(transactionItem);
      });

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeActivityModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Settings button functionality
    document.getElementById('settingsBtn').addEventListener('click', function(e) {
      e.preventDefault();
      showSettingsModal();
    });

    function showSettingsModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '700px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 24px; font-weight: bold; margin-bottom: 4px;">Settings</h2>
            <p style="color: #94a3b8; font-size: 14px;">Manage your account and preferences</p>
          </div>
          <button id="closeSettingsModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Settings sections
      const settingsSections = [
        {
          title: 'Account',
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>`,
          items: [
            { label: 'Personal Information', description: 'Update your name, email, and phone' },
            { label: 'Verification Status', description: 'Complete KYC verification' },
            { label: 'Connected Wallets', description: 'Manage your crypto wallets' }
          ]
        },
        {
          title: 'Security',
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>`,
          items: [
            { label: 'Change Password', description: 'Update your login password' },
            { label: 'Two-Factor Authentication', description: 'Enable 2FA for extra security' },
            { label: 'Biometric Login', description: 'Use fingerprint or face recognition' },
            { label: 'Active Sessions', description: 'Manage logged-in devices' }
          ]
        },
        {
          title: 'Notifications',
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>`,
          items: [
            { label: 'Push Notifications', description: 'Transaction and activity alerts' },
            { label: 'Email Notifications', description: 'Receive updates via email' },
            { label: 'Price Alerts', description: 'Get notified of price changes' }
          ]
        },
        {
          title: 'Privacy',
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>`,
          items: [
            { label: 'Data Privacy', description: 'Control your data sharing' },
            { label: 'Activity History', description: 'Download or delete your data' }
          ]
        },
        {
          title: 'Preferences',
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2v6m0 6v6m5.2-13.2L13.4 9.6m-2.8 2.8l-3.8 3.8m13.2.8h-6m-6 0H1m13.2-5.2l-3.8 3.8m-2.8-2.8L3.8 3.8"></path>
          </svg>`,
          items: [
            { label: 'Language', description: 'English (US)' },
            { label: 'Currency Display', description: 'USD ($)' },
            { label: 'Dark Mode', description: 'Currently enabled' }
          ]
        }
      ];

      settingsSections.forEach((section, sectionIndex) => {
        // Section header
        const sectionHeader = document.createElement('div');
        sectionHeader.style.marginBottom = '16px';
        if (sectionIndex > 0) {
          sectionHeader.style.marginTop = '32px';
        }
        sectionHeader.innerHTML = `
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
            <div style="color: #ff5722;">
              ${section.icon}
            </div>
            <h3 style="color: #ffffff; font-size: 16px; font-weight: 600;">${section.title}</h3>
          </div>
        `;
        body.appendChild(sectionHeader);

        // Section items
        section.items.forEach((item, itemIndex) => {
          const settingItem = document.createElement('button');
          settingItem.style.width = '100%';
          settingItem.style.padding = '16px';
          settingItem.style.marginBottom = '8px';
          settingItem.style.borderRadius = '12px';
          settingItem.style.background = 'rgba(255, 87, 34, 0.05)';
          settingItem.style.border = '1px solid rgba(255, 87, 34, 0.15)';
          settingItem.style.transition = 'all 0.3s ease';
          settingItem.style.cursor = 'pointer';
          settingItem.style.textAlign = 'left';
          settingItem.onmouseenter = function() {
            this.style.background = 'rgba(255, 87, 34, 0.1)';
            this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
            this.style.transform = 'translateX(4px)';
          };
          settingItem.onmouseleave = function() {
            this.style.background = 'rgba(255, 87, 34, 0.05)';
            this.style.borderColor = 'rgba(255, 87, 34, 0.15)';
            this.style.transform = 'translateX(0)';
          };

          settingItem.innerHTML = `
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div style="flex: 1;">
                <div style="color: #ffffff; font-size: 15px; font-weight: 500; margin-bottom: 4px;">${item.label}</div>
                <div style="color: #64748b; font-size: 13px;">${item.description}</div>
              </div>
              <div style="flex-shrink: 0; margin-left: 16px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="2">
                  <path d="M9 18l6-6-6-6"></path>
                </svg>
              </div>
            </div>
          `;

          settingItem.addEventListener('click', function() {
            // Show toast notification
            const toast = document.createElement('div');
            toast.style.position = 'fixed';
            toast.style.bottom = '24px';
            toast.style.right = '24px';
            toast.style.padding = '16px 24px';
            toast.style.borderRadius = '12px';
            toast.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
            toast.style.color = '#ffffff';
            toast.style.fontWeight = '600';
            toast.style.fontSize = '14px';
            toast.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
            toast.style.zIndex = '3000';
            toast.textContent = `${item.label} - Coming soon!`;
            document.body.appendChild(toast);

            setTimeout(() => {
              toast.remove();
            }, 3000);
          });

          body.appendChild(settingItem);
        });
      });

      // Logout button
      const logoutSection = document.createElement('div');
      logoutSection.style.marginTop = '32px';
      logoutSection.style.paddingTop = '24px';
      logoutSection.style.borderTop = '1px solid rgba(255, 87, 34, 0.2)';
      
      const logoutButton = document.createElement('button');
      logoutButton.style.width = '100%';
      logoutButton.style.padding = '16px';
      logoutButton.style.borderRadius = '12px';
      logoutButton.style.background = 'rgba(239, 68, 68, 0.1)';
      logoutButton.style.border = '1px solid rgba(239, 68, 68, 0.3)';
      logoutButton.style.color = '#ef4444';
      logoutButton.style.fontWeight = '600';
      logoutButton.style.fontSize = '15px';
      logoutButton.style.cursor = 'pointer';
      logoutButton.style.transition = 'all 0.3s ease';
      logoutButton.onmouseenter = function() {
        this.style.background = 'rgba(239, 68, 68, 0.15)';
        this.style.borderColor = 'rgba(239, 68, 68, 0.5)';
      };
      logoutButton.onmouseleave = function() {
        this.style.background = 'rgba(239, 68, 68, 0.1)';
        this.style.borderColor = 'rgba(239, 68, 68, 0.3)';
      };
      logoutButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          <span>Log Out</span>
        </div>
      `;
      logoutButton.addEventListener('click', function() {
        const toast = document.createElement('div');
        toast.style.position = 'fixed';
        toast.style.bottom = '24px';
        toast.style.right = '24px';
        toast.style.padding = '16px 24px';
        toast.style.borderRadius = '12px';
        toast.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
        toast.style.color = '#ffffff';
        toast.style.fontWeight = '600';
        toast.style.fontSize = '14px';
        toast.style.boxShadow = '0 4px 12px rgba(239, 68, 68, 0.4)';
        toast.style.zIndex = '3000';
        toast.textContent = 'Logout functionality coming soon!';
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 3000);
      });

      logoutSection.appendChild(logoutButton);
      body.appendChild(logoutSection);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeSettingsModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Help & Support button functionality
    document.getElementById('helpBtn').addEventListener('click', function(e) {
      e.preventDefault();
      showHelpModal();
    });

    function showHelpModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '700px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 24px; font-weight: bold; margin-bottom: 4px;">Help & Support</h2>
            <p style="color: #94a3b8; font-size: 14px;">We're here to help you 24/7</p>
          </div>
          <button id="closeHelpModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Contact options
      const contactSection = document.createElement('div');
      contactSection.style.marginBottom = '32px';
      contactSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px;">Contact Us</h3>
      `;

      const contactOptions = [
        {
          icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>`,
          title: 'Live Chat',
          description: 'Chat with our support team',
          status: 'Available now',
          statusColor: '#10b981'
        },
        {
          icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
            <polyline points="22,6 12,13 2,6"></polyline>
          </svg>`,
          title: 'Email Support',
          description: 'support@cryptoloan.com',
          status: 'Response within 24h',
          statusColor: '#6366f1'
        },
        {
          icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
          </svg>`,
          title: 'Phone Support',
          description: '+1 (800) 123-4567',
          status: 'Mon-Fri 9AM-6PM EST',
          statusColor: '#f59e0b'
        }
      ];

      contactOptions.forEach(option => {
        const optionButton = document.createElement('button');
        optionButton.style.width = '100%';
        optionButton.style.padding = '16px';
        optionButton.style.marginBottom = '12px';
        optionButton.style.borderRadius = '12px';
        optionButton.style.background = 'rgba(255, 87, 34, 0.05)';
        optionButton.style.border = '1px solid rgba(255, 87, 34, 0.15)';
        optionButton.style.transition = 'all 0.3s ease';
        optionButton.style.cursor = 'pointer';
        optionButton.style.textAlign = 'left';
        optionButton.onmouseenter = function() {
          this.style.background = 'rgba(255, 87, 34, 0.1)';
          this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
          this.style.transform = 'translateY(-2px)';
        };
        optionButton.onmouseleave = function() {
          this.style.background = 'rgba(255, 87, 34, 0.05)';
          this.style.borderColor = 'rgba(255, 87, 34, 0.15)';
          this.style.transform = 'translateY(0)';
        };

        optionButton.innerHTML = `
          <div style="display: flex; align-items: center; gap: 16px;">
            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(255, 87, 34, 0.1); display: flex; align-items: center; justify-content: center; flex-shrink: 0; color: #ff5722;">
              ${option.icon}
            </div>
            <div style="flex: 1;">
              <div style="color: #ffffff; font-size: 15px; font-weight: 600; margin-bottom: 4px;">${option.title}</div>
              <div style="color: #94a3b8; font-size: 13px; margin-bottom: 4px;">${option.description}</div>
              <div style="display: flex; align-items: center; gap: 6px;">
                <div style="width: 6px; height: 6px; border-radius: 50%; background: ${option.statusColor};"></div>
                <span style="color: ${option.statusColor}; font-size: 12px; font-weight: 500;">${option.status}</span>
              </div>
            </div>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="2" style="flex-shrink: 0;">
              <path d="M9 18l6-6-6-6"></path>
            </svg>
          </div>
        `;

        optionButton.addEventListener('click', function() {
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '16px 24px';
          toast.style.borderRadius = '12px';
          toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '14px';
          toast.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = `Opening ${option.title}...`;
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 3000);
        });

        contactSection.appendChild(optionButton);
      });

      body.appendChild(contactSection);

      // FAQ Section
      const faqSection = document.createElement('div');
      faqSection.style.marginBottom = '32px';
      faqSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px;">Frequently Asked Questions</h3>
      `;

      const faqs = [
        {
          question: 'How do Bitcoin-backed loans work?',
          answer: 'You deposit Bitcoin as collateral and receive a USD loan. Your Bitcoin remains secure while you get instant liquidity.'
        },
        {
          question: 'What are the interest rates?',
          answer: 'Our rates start at 10% APR for standard members and 9.5% APR for premium members. Rates may vary based on loan amount and term.'
        },
        {
          question: 'What is the Loan-to-Value (LTV) ratio?',
          answer: 'We offer up to 50% LTV, meaning you can borrow up to 50% of your Bitcoin collateral value. This helps protect against market volatility.'
        },
        {
          question: 'What happens if Bitcoin price drops?',
          answer: 'If your LTV exceeds 65%, we will send margin call notifications. At 75% LTV, partial liquidation may occur to maintain safe ratios.'
        },
        {
          question: 'How quickly can I get my loan?',
          answer: 'Once your Bitcoin collateral is confirmed on the blockchain (typically 30-60 minutes), your USD loan is disbursed immediately.'
        },
        {
          question: 'Can I repay my loan early?',
          answer: 'Yes! There are no prepayment penalties. You can repay your loan at any time and your collateral will be released immediately.'
        }
      ];

      faqs.forEach(faq => {
        const faqItem = document.createElement('button');
        faqItem.style.width = '100%';
        faqItem.style.padding = '16px';
        faqItem.style.marginBottom = '12px';
        faqItem.style.borderRadius = '12px';
        faqItem.style.background = 'rgba(99, 102, 241, 0.05)';
        faqItem.style.border = '1px solid rgba(99, 102, 241, 0.15)';
        faqItem.style.transition = 'all 0.3s ease';
        faqItem.style.cursor = 'pointer';
        faqItem.style.textAlign = 'left';
        faqItem.onmouseenter = function() {
          this.style.background = 'rgba(99, 102, 241, 0.1)';
          this.style.borderColor = 'rgba(99, 102, 241, 0.3)';
        };
        faqItem.onmouseleave = function() {
          this.style.background = 'rgba(99, 102, 241, 0.05)';
          this.style.borderColor = 'rgba(99, 102, 241, 0.15)';
        };

        faqItem.innerHTML = `
          <div style="display: flex; align-items: start; justify-content: space-between; gap: 12px;">
            <div style="flex: 1;">
              <div style="color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 8px;">${faq.question}</div>
              <div style="color: #94a3b8; font-size: 13px; line-height: 1.6;">${faq.answer}</div>
            </div>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </div>
        `;

        faqSection.appendChild(faqItem);
      });

      body.appendChild(faqSection);

      // Help Resources
      const resourcesSection = document.createElement('div');
      resourcesSection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px;">Help Resources</h3>
      `;

      const resources = [
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
          </svg>`,
          title: 'User Guide',
          description: 'Complete guide to using CryptoLoan'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polygon points="10 8 16 12 10 16 10 8"></polygon>
          </svg>`,
          title: 'Video Tutorials',
          description: 'Watch step-by-step video guides'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
          </svg>`,
          title: 'Documentation',
          description: 'Detailed API and technical docs'
        },
        {
          icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>`,
          title: 'Community Forum',
          description: 'Connect with other users'
        }
      ];

      resources.forEach(resource => {
        const resourceButton = document.createElement('button');
        resourceButton.style.width = '100%';
        resourceButton.style.padding = '14px';
        resourceButton.style.marginBottom = '10px';
        resourceButton.style.borderRadius = '12px';
        resourceButton.style.background = 'rgba(255, 87, 34, 0.05)';
        resourceButton.style.border = '1px solid rgba(255, 87, 34, 0.15)';
        resourceButton.style.transition = 'all 0.3s ease';
        resourceButton.style.cursor = 'pointer';
        resourceButton.style.textAlign = 'left';
        resourceButton.onmouseenter = function() {
          this.style.background = 'rgba(255, 87, 34, 0.1)';
          this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
        };
        resourceButton.onmouseleave = function() {
          this.style.background = 'rgba(255, 87, 34, 0.05)';
          this.style.borderColor = 'rgba(255, 87, 34, 0.15)';
        };

        resourceButton.innerHTML = `
          <div style="display: flex; align-items: center; gap: 12px;">
            <div style="color: #ff5722;">
              ${resource.icon}
            </div>
            <div style="flex: 1;">
              <div style="color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 2px;">${resource.title}</div>
              <div style="color: #94a3b8; font-size: 12px;">${resource.description}</div>
            </div>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="2" style="flex-shrink: 0;">
              <path d="M9 18l6-6-6-6"></path>
            </svg>
          </div>
        `;

        resourceButton.addEventListener('click', function() {
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '16px 24px';
          toast.style.borderRadius = '12px';
          toast.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '14px';
          toast.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = `Opening ${resource.title}...`;
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 3000);
        });

        resourcesSection.appendChild(resourceButton);
      });

      body.appendChild(resourcesSection);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeHelpModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // View All Activity button functionality
    document.getElementById('viewAllActivityBtn').addEventListener('click', function() {
      const tempContent = document.createElement('div');
      tempContent.className = 'fixed bottom-4 right-4 px-6 py-3 rounded-lg font-semibold z-50';
      tempContent.style.background = 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)';
      tempContent.style.color = '#ffffff';
      tempContent.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
      tempContent.textContent = 'Full activity history coming soon!';
      document.body.appendChild(tempContent);
      
      setTimeout(() => {
        tempContent.remove();
      }, 3000);
    });

    // Subscribe button functionality
    document.getElementById('subscribeBtn').addEventListener('click', function() {
      showDepositRequirementModal();
    });

    function showDepositRequirementModal() {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 22px; font-weight: bold; margin-bottom: 6px;">Deposit Required</h2>
            <p style="color: #94a3b8; font-size: 13px;">Deposit $1,000 equivalent to unlock loan eligibility</p>
          </div>
          <button id="closeDepositModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Info Card
      const infoCard = document.createElement('div');
      infoCard.style.padding = '20px';
      infoCard.style.marginBottom = '24px';
      infoCard.style.borderRadius = '16px';
      infoCard.style.background = 'rgba(99, 102, 241, 0.1)';
      infoCard.style.border = '1px solid rgba(99, 102, 241, 0.3)';
      infoCard.innerHTML = `
        <div style="display: flex; gap: 14px; align-items: start;">
          <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(99, 102, 241, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2.5">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 8px;">Eligibility Requirement</h3>
            <p style="color: #cbd5e1; font-size: 14px; line-height: 1.6;">To become eligible for Bitcoin-backed loans, you must deposit at least <strong style="color: #6366f1;">$1,000</strong> equivalent in cryptocurrency. This deposit will be held as your initial collateral.</p>
          </div>
        </div>
      `;
      body.appendChild(infoCard);

      // Currency Selection
      const currencySection = document.createElement('div');
      currencySection.style.marginBottom = '24px';
      currencySection.innerHTML = `
        <h3 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px;">Select Deposit Currency</h3>
      `;

      const currencies = [
        { name: 'Bitcoin', symbol: 'BTC', network: 'Bitcoin Network', address: 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh', color: '#f7931a' },
        { name: 'Ethereum', symbol: 'ETH', network: 'Ethereum Network', address: '0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb', color: '#627eea' },
        { name: 'USDT', symbol: 'USDT', network: 'BEP-20 (BSC)', address: '0x8894E0a0c962CB723c1976a4421c95949bE2D4E3', color: '#26a17b' },
        { name: 'USDT', symbol: 'USDT', network: 'TRC-20 (Tron)', address: 'TYDzsYUEpvnYmQk4zGP9sWWcTEd2MiAtW6', color: '#26a17b' },
        { name: 'USDC', symbol: 'USDC', network: 'BEP-20 (BSC)', address: '0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d', color: '#2775ca' },
        { name: 'USDC', symbol: 'USDC', network: 'TRC-20 (Tron)', address: 'TEkxiTehnzSmSe2XqrBj4w32RUN966rdz8', color: '#2775ca' }
      ];

      currencies.forEach((currency, index) => {
        const currencyButton = document.createElement('button');
        currencyButton.className = 'currency-option';
        currencyButton.style.width = '100%';
        currencyButton.style.padding = '16px';
        currencyButton.style.marginBottom = '12px';
        currencyButton.style.borderRadius = '12px';
        currencyButton.style.background = 'rgba(255, 87, 34, 0.05)';
        currencyButton.style.border = '2px solid rgba(255, 87, 34, 0.15)';
        currencyButton.style.cursor = 'pointer';
        currencyButton.style.transition = 'all 0.3s ease';
        currencyButton.style.textAlign = 'left';
        currencyButton.onmouseenter = function() {
          if (!this.classList.contains('selected')) {
            this.style.background = 'rgba(255, 87, 34, 0.1)';
            this.style.borderColor = 'rgba(255, 87, 34, 0.3)';
          }
        };
        currencyButton.onmouseleave = function() {
          if (!this.classList.contains('selected')) {
            this.style.background = 'rgba(255, 87, 34, 0.05)';
            this.style.borderColor = 'rgba(255, 87, 34, 0.15)';
          }
        };

        currencyButton.innerHTML = `
          <div style="display: flex; align-items: center; gap: 14px;">
            <div style="width: 44px; height: 44px; border-radius: 50%; background: ${currency.color}; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
              <span style="color: #ffffff; font-weight: bold; font-size: 14px;">${currency.symbol.substring(0, 1)}</span>
            </div>
            <div style="flex: 1;">
              <div style="color: #ffffff; font-size: 15px; font-weight: 600; margin-bottom: 3px;">${currency.name} (${currency.symbol})</div>
              <div style="color: #94a3b8; font-size: 12px;">${currency.network}</div>
            </div>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="2" style="flex-shrink: 0;">
              <path d="M9 18l6-6-6-6"></path>
            </svg>
          </div>
        `;

        currencyButton.addEventListener('click', function() {
          showDepositAddressModal(currency);
          modal.remove();
        });

        currencySection.appendChild(currencyButton);
      });

      body.appendChild(currencySection);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Close modal functionality
      document.getElementById('closeDepositModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function showDepositAddressModal(currency) {
      // Create modal overlay
      const modal = document.createElement('div');
      modal.className = 'modal show';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.right = '0';
      modal.style.bottom = '0';
      modal.style.background = 'rgba(0, 0, 0, 0.8)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '2000';
      modal.style.padding = '20px';

      // Create modal content
      const modalContent = document.createElement('div');
      modalContent.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)';
      modalContent.style.border = '1px solid rgba(255, 87, 34, 0.3)';
      modalContent.style.borderRadius = '24px';
      modalContent.style.maxWidth = '600px';
      modalContent.style.width = '100%';
      modalContent.style.maxHeight = '90%';
      modalContent.style.overflowY = 'auto';
      modalContent.style.boxShadow = '0 20px 60px rgba(0, 0, 0, 0.5)';

      // Modal header
      const header = document.createElement('div');
      header.style.padding = '24px';
      header.style.borderBottom = '1px solid rgba(255, 87, 34, 0.2)';
      header.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: #ffffff; font-size: 22px; font-weight: bold; margin-bottom: 6px;">Deposit ${currency.name}</h2>
            <p style="color: #94a3b8; font-size: 13px;">${currency.network}</p>
          </div>
          <button id="closeAddressModal" style="background: rgba(255, 87, 34, 0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      `;

      // Modal body
      const body = document.createElement('div');
      body.style.padding = '24px';

      // Deposit Amount Card
      const amountCard = document.createElement('div');
      amountCard.style.padding = '20px';
      amountCard.style.marginBottom = '24px';
      amountCard.style.borderRadius = '16px';
      amountCard.style.background = `linear-gradient(135deg, ${currency.color}20 0%, ${currency.color}10 100%)`;
      amountCard.style.border = `1px solid ${currency.color}40`;
      amountCard.innerHTML = `
        <div style="text-align: center;">
          <p style="color: #94a3b8; font-size: 13px; margin-bottom: 8px;">Required Deposit Amount</p>
          <p style="color: #ffffff; font-size: 32px; font-weight: bold; margin-bottom: 8px;">$1,000</p>
          <p style="color: #cbd5e1; font-size: 13px;">or equivalent in ${currency.symbol}</p>
        </div>
      `;
      body.appendChild(amountCard);

      // Warning Alert
      const warningAlert = document.createElement('div');
      warningAlert.style.padding = '16px';
      warningAlert.style.marginBottom = '24px';
      warningAlert.style.borderRadius = '12px';
      warningAlert.style.background = 'rgba(245, 158, 11, 0.1)';
      warningAlert.style.border = '1px solid rgba(245, 158, 11, 0.3)';
      warningAlert.innerHTML = `
        <div style="display: flex; gap: 12px; align-items: start;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" style="flex-shrink: 0; margin-top: 2px;">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <div>
            <h4 style="color: #f59e0b; font-size: 14px; font-weight: 600; margin-bottom: 6px;">Important Notice</h4>
            <ul style="color: #fbbf24; font-size: 13px; line-height: 1.8; margin: 0; padding-left: 20px;">
              <li style="margin-bottom: 4px;">Only send ${currency.symbol} on ${currency.network}</li>
              <li style="margin-bottom: 4px;">Minimum deposit: $1,000 equivalent</li>
              <li style="margin-bottom: 4px;">Sending other coins will result in permanent loss</li>
              <li>Wait for blockchain confirmation before proceeding</li>
            </ul>
          </div>
        </div>
      `;
      body.appendChild(warningAlert);

      // Deposit Address Section
      const addressSection = document.createElement('div');
      addressSection.style.marginBottom = '24px';
      addressSection.innerHTML = `
        <label style="display: block; color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 12px;">
          Deposit Address
        </label>
        <div style="position: relative; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 87, 34, 0.2); border-radius: 12px; padding: 14px 50px 14px 16px;">
          <p id="depositAddress" style="color: #ffffff; font-size: 13px; font-family: monospace; word-break: break-all; margin: 0;">${currency.address}</p>
          <button id="copyAddressBtn" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: rgba(255, 87, 34, 0.1); border: none; width: 36px; height: 36px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.2)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
          </button>
        </div>
        <p style="color: #64748b; font-size: 12px; margin-top: 8px;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle; margin-right: 4px;">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          Click the copy icon to copy the address
        </p>
      `;
      body.appendChild(addressSection);

      // Transaction Steps
      const stepsSection = document.createElement('div');
      stepsSection.style.marginBottom = '24px';
      stepsSection.innerHTML = `
        <h4 style="color: #ffffff; font-size: 14px; font-weight: 600; margin-bottom: 14px;">Next Steps</h4>
      `;

      const steps = [
        'Copy the deposit address above',
        'Send at least $1,000 equivalent in ' + currency.symbol,
        'Wait for blockchain confirmation (typically 10-60 minutes)',
        'Click "I Have Made Payment" button below'
      ];

      steps.forEach((step, index) => {
        const stepItem = document.createElement('div');
        stepItem.style.display = 'flex';
        stepItem.style.gap = '12px';
        stepItem.style.alignItems = 'start';
        stepItem.style.marginBottom = '12px';
        stepItem.innerHTML = `
          <div style="width: 28px; height: 28px; border-radius: 50%; background: linear-gradient(135deg, #ff5722 0%, #ff7043 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <span style="color: #ffffff; font-weight: bold; font-size: 13px;">${index + 1}</span>
          </div>
          <p style="color: #cbd5e1; font-size: 13px; line-height: 1.6; margin: 0; padding-top: 4px;">${step}</p>
        `;
        stepsSection.appendChild(stepItem);
      });

      body.appendChild(stepsSection);

      // Payment Confirmation Button
      const confirmButton = document.createElement('button');
      confirmButton.id = 'confirmPaymentBtn';
      confirmButton.style.width = '100%';
      confirmButton.style.padding = '16px';
      confirmButton.style.borderRadius = '12px';
      confirmButton.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
      confirmButton.style.border = 'none';
      confirmButton.style.color = '#ffffff';
      confirmButton.style.fontSize = '15px';
      confirmButton.style.fontWeight = '700';
      confirmButton.style.cursor = 'pointer';
      confirmButton.style.transition = 'all 0.3s ease';
      confirmButton.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.3)';
      confirmButton.onmouseenter = function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(16, 185, 129, 0.5)';
      };
      confirmButton.onmouseleave = function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.3)';
      };
      confirmButton.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          <span>I Have Made Payment</span>
        </div>
      `;

      confirmButton.addEventListener('click', function() {
        verifyPaymentAndUnlock(currency, modal);
      });

      body.appendChild(confirmButton);

      modalContent.appendChild(header);
      modalContent.appendChild(body);
      modal.appendChild(modalContent);
      document.body.appendChild(modal);

      // Copy address functionality
      document.getElementById('copyAddressBtn').addEventListener('click', function() {
        const address = document.getElementById('depositAddress').textContent;
        navigator.clipboard.writeText(address).then(() => {
          // Show success feedback
          this.innerHTML = `
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          `;
          
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '12px 20px';
          toast.style.borderRadius = '10px';
          toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '13px';
          toast.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = 'Address copied to clipboard!';
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 2000);

          // Reset icon after 2 seconds
          setTimeout(() => {
            this.innerHTML = `
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff5722" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            `;
          }, 2000);
        }).catch(err => {
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '12px 20px';
          toast.style.borderRadius = '10px';
          toast.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '13px';
          toast.style.boxShadow = '0 4px 12px rgba(239, 68, 68, 0.4)';
          toast.style.zIndex = '3000';
          toast.textContent = 'Failed to copy address';
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 2000);
        });
      });

      // Close modal functionality
      document.getElementById('closeAddressModal').addEventListener('click', function() {
        modal.remove();
      });

      // Close modal when clicking overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function verifyPaymentAndUnlock(currency, previousModal) {
      // Create verification overlay
      const verificationOverlay = document.createElement('div');
      verificationOverlay.style.position = 'fixed';
      verificationOverlay.style.top = '0';
      verificationOverlay.style.left = '0';
      verificationOverlay.style.right = '0';
      verificationOverlay.style.bottom = '0';
      verificationOverlay.style.background = 'rgba(0, 0, 0, 0.95)';
      verificationOverlay.style.display = 'flex';
      verificationOverlay.style.alignItems = 'center';
      verificationOverlay.style.justifyContent = 'center';
      verificationOverlay.style.zIndex = '3000';
      verificationOverlay.style.padding = '20px';

      verificationOverlay.innerHTML = `
        <div style="text-align: center; max-width: 400px;">
          <div style="width: 80px; height: 80px; border: 4px solid rgba(255, 87, 34, 0.2); border-top-color: #ff5722; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 24px;"></div>
          <h3 style="color: #ffffff; font-size: 22px; font-weight: 700; margin-bottom: 12px;">Verifying Payment</h3>
          <p style="color: #94a3b8; font-size: 14px; margin-bottom: 20px;">Checking blockchain for your deposit...</p>
          <div id="verificationSteps" style="text-align: left; max-width: 320px; margin: 0 auto;">
            <div class="verify-step" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
              <div class="verify-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: 13px;">Scanning blockchain</span>
            </div>
            <div class="verify-step" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
              <div class="verify-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: 13px;">Verifying transaction</span>
            </div>
            <div class="verify-step" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
              <div class="verify-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: 13px;">Confirming amount</span>
            </div>
            <div class="verify-step" style="display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4;">
              <div class="verify-icon" style="width: 24px; height: 24px; border-radius: 50%; border: 2px solid #64748b; display: flex; align-items: center; justify-content: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: #64748b;"></div>
              </div>
              <span style="color: #94a3b8; font-size: 13px;">Unlocking loan access</span>
            </div>
          </div>
        </div>
        <style>
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      `;

      document.body.appendChild(verificationOverlay);

      // Animate verification steps
      const steps = verificationOverlay.querySelectorAll('.verify-step');
      let currentStep = 0;

      const animateStep = () => {
        if (currentStep < steps.length) {
          const step = steps[currentStep];
          step.style.opacity = '1';
          const icon = step.querySelector('.verify-icon');
          icon.style.borderColor = '#ff5722';
          icon.querySelector('div').style.background = '#ff5722';

          setTimeout(() => {
            icon.innerHTML = `
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            `;
            icon.style.background = '#10b981';
            icon.style.borderColor = '#10b981';

            currentStep++;
            if (currentStep < steps.length) {
              setTimeout(animateStep, 700);
            } else {
              setTimeout(showSuccessScreen, 800);
            }
          }, 800);
        }
      };

      const showSuccessScreen = () => {
        verificationOverlay.innerHTML = `
          <div style="text-align: center; max-width: 500px; padding: 40px;">
            <div style="width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg, #10b981 0%, #059669 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);">
              <svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            </div>
            <h3 style="color: #ffffff; font-size: 28px; font-weight: 700; margin-bottom: 16px;">Payment Verified!</h3>
            <p style="color: #10b981; font-size: 18px; font-weight: 600; margin-bottom: 12px;">$1,000.00 Received</p>
            <p style="color: #94a3b8; font-size: 14px; margin-bottom: 32px;">Your deposit has been confirmed on the ${currency.network}. You are now eligible to apply for Bitcoin-backed loans!</p>

            <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 24px; text-align: left;">
              <h4 style="color: #ffffff; font-size: 15px; font-weight: 600; margin-bottom: 14px;">Loan Access Unlocked</h4>
              <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span style="color: #cbd5e1; font-size: 13px;">Maximum loan amount: Up to $1,000,000</span>
              </div>
              <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span style="color: #cbd5e1; font-size: 13px;">Flexible terms: 30 to 365 days</span>
              </div>
              <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span style="color: #cbd5e1; font-size: 13px;">Competitive rates starting at 10% APR</span>
              </div>
              <div style="display: flex; align-items: center; gap: 10px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span style="color: #cbd5e1; font-size: 13px;">Instant approval in under 1 minute</span>
              </div>
            </div>

            <button id="continueToLoans" style="width: 100%; padding: 18px; border-radius: 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; color: #ffffff; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); margin-bottom: 12px;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
              <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                  <line x1="12" y1="1" x2="12" y2="23"></line>
                  <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
                <span>Apply for Loan Now</span>
              </div>
            </button>
            <button id="returnDashboard" style="width: 100%; padding: 16px; border-radius: 12px; background: rgba(255, 87, 34, 0.1); border: 1px solid rgba(255, 87, 34, 0.3); color: #ff5722; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 87, 34, 0.15)'" onmouseout="this.style.background='rgba(255, 87, 34, 0.1)'">
              Return to Dashboard
            </button>
          </div>
        `;

        // Button functionality
        document.getElementById('continueToLoans').addEventListener('click', function() {
          verificationOverlay.remove();
          if (previousModal) previousModal.remove();
          showLoanCalculatorModal();
        });

        document.getElementById('returnDashboard').addEventListener('click', function() {
          verificationOverlay.remove();
          if (previousModal) previousModal.remove();

          // Show success toast
          const toast = document.createElement('div');
          toast.style.position = 'fixed';
          toast.style.bottom = '24px';
          toast.style.right = '24px';
          toast.style.padding = '16px 24px';
          toast.style.borderRadius = '12px';
          toast.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
          toast.style.color = '#ffffff';
          toast.style.fontWeight = '600';
          toast.style.fontSize = '14px';
          toast.style.boxShadow = '0 8px 24px rgba(16, 185, 129, 0.5)';
          toast.style.zIndex = '3000';
          toast.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              <span>Loan eligibility unlocked! You can now apply for loans.</span>
            </div>
          `;
          document.body.appendChild(toast);

          setTimeout(() => {
            toast.remove();
          }, 5000);
        });
      };

      // Start animation
      setTimeout(animateStep, 500);
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ac37fb8e054b78a',t:'MTc2NTQ0MDU1Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
